/*
 * Copyright (c) 2019 by Filestack.
 * Some rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define("filestack",["exports"],e):e(t.filestack={})}(this,function(t){"use strict";var e;function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e={urls:{fileApiUrl:"https://www.filestackapi.com/api/file",uploadApiUrl:"https://upload.filestackapi.com",cloudApiUrl:"https://cloud.filestackapi.com",cdnUrl:"https://cdn.filestackcontent.com",pickerUrl:"https://static.filestackapi.com/picker/1.4.4/picker.js"}};var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var i=function(){return(i=Object.assign||function(t){for(var e,r=1,n=arguments.length;n>r;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function o(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function s(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(a,s)}u((n=n.apply(t,e||[])).next())})}function a(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&i[3]>o[1])){a.label=o[1];break}if(6===o[0]&&i[1]>a.label){a.label=i[1],i=o;break}if(i&&i[2]>a.label){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var s=function(t){return"function"==typeof t},u=function(t){return null==t},c=function(t){return t.displayName||t.name||"<function"+t.length+">"};function p(t,e){return"function"==typeof e?c(e):e}var f=function(t){try{return JSON.stringify(t,p,2)}catch(e){return t+""}};function l(t,e){!0!==t&&(s(e)?e=e():u(e)&&(e='Assert failed (turn on "Pause on exceptions" in your Source panel)'),l.fail(e))}l.fail=function(t){throw new TypeError("[tcomb] "+t)},l.stringify=f;var h=l,m=function(t){return"string"==typeof t},d=function(t){return Array.isArray?Array.isArray(t):t instanceof Array},y=function(t){return!u(t)&&"object"===r(t)&&!d(t)},g=function(t){return s(t)&&y(t.meta)},v=function(t){return g(t)?t.displayName:c(t)},b=function(t,e){h(!(t instanceof e),function(){return"Cannot use the new operator to instantiate the type "+v(e)})},w=function(t,e){function r(n,i){return b(this,r),i=i||[t],h(e(n),function(){return"Invalid value "+h.stringify(n)+" supplied to "+i.join("/")}),n}return h(m(t),function(){return"Invalid argument name "+h.stringify(t)+" supplied to irreducible(name, predicate) (expected a string)"}),h(s(e),"Invalid argument predicate "+h.stringify(e)+" supplied to irreducible(name, predicate) (expected a function)"),r.meta={kind:"irreducible",name:t,predicate:e,identity:!0},r.displayName=t,r.is=e,r},x=w("Any",function(){return!0}),k=w("Array",d),_=function(t){return!0===t||!1===t},E=w("Boolean",_),A=w("Date",function(t){return t instanceof Date}),P=w("Error",function(t){return t instanceof Error}),O=w("Function",s),T=w("Nil",u),j=function(t){return"number"==typeof t&&isFinite(t)&&!isNaN(t)},S=w("Number",j),I=function(t){return u(t)||m(t)},R=function(t){return!g(t)||(h(E.is(t.meta.identity),function(){return"Invalid meta identity "+h.stringify(t.meta.identity)+" supplied to type "+v(t)}),t.meta.identity)},C=function(t,e,n){return g(t)?t.meta.identity||"object"!==r(e)||null===e?t(e,n):new t(e,n):(n=n||[c(t)],h(e instanceof t,function(){return"Invalid value "+f(e)+" supplied to "+n.join("/")}),e)},U=function(t,e){return g(e)?e.is(t):t instanceof e};function F(t,e){return"{"+v(t)+" | "+c(e)+"}"}function D(t,e,r){h(s(t),function(){return"Invalid argument type "+h.stringify(t)+" supplied to refinement(type, predicate, [name]) combinator (expected a type)"}),h(s(e),function(){return"Invalid argument predicate supplied to refinement(type, predicate, [name]) combinator (expected a function)"}),h(I(r),function(){return"Invalid argument name "+h.stringify(r)+" supplied to refinement(type, predicate, [name]) combinator (expected a string)"});var n=r||F(t,e),i=R(t);function o(r,a){i&&b(this,o);var s=C(t,r,a=a||[n]);return h(e(s),function(){return"Invalid value "+h.stringify(r)+" supplied to "+a.join("/")}),s}return o.meta={kind:"subtype",type:t,predicate:e,name:r,identity:i},o.displayName=n,o.is=function(r){return U(r,t)&&e(r)},o.update=function(t,e){return o(h.update(t,e))},o}D.getDefaultName=F;var z=D,q=z(S,function(t){return t%1==0},"Integer"),B=w("Object",y),$=w("RegExp",function(t){return t instanceof RegExp}),N=w("String",m),M=w("Type",g);function L(t,e){return"{[key: "+v(t)+"]: "+v(e)+"}"}function V(t,e,r){h(s(t),function(){return"Invalid argument domain "+h.stringify(t)+" supplied to dict(domain, codomain, [name]) combinator (expected a type)"}),h(s(e),function(){return"Invalid argument codomain "+h.stringify(e)+" supplied to dict(domain, codomain, [name]) combinator (expected a type)"}),h(I(r),function(){return"Invalid argument name "+h.stringify(r)+" supplied to dict(domain, codomain, [name]) combinator (expected a string)"});var n=r||L(t,e),i=v(t),o=v(e),a=R(t)&&R(e);function u(r,a){a=a||[n],h(y(r),function(){return"Invalid value "+h.stringify(r)+" supplied to "+a.join("/")});var s=!0,u={};for(var c in r)if(r.hasOwnProperty(c)){c=C(t,c,a.concat(i));var p=r[c],f=C(e,p,a.concat(c+": "+o));s=s&&p===f,u[c]=f}return s&&(u=r),Object.freeze(u),u}return u.meta={kind:"dict",domain:t,codomain:e,name:r,identity:a},u.displayName=n,u.is=function(r){if(!y(r))return!1;for(var n in r)if(r.hasOwnProperty(n)&&(!U(n,t)||!U(r[n],e)))return!1;return!0},u.update=function(t,e){return u(h.update(t,e))},u}V.getDefaultName=L;var Y=V,H=function(t,e,r){if(u(e))return t;for(var n in e)e.hasOwnProperty(n)&&(!0!==r&&h(!t.hasOwnProperty(n)||t[n]===e[n],function(){return'Invalid call to mixin(target, source, [overwrite]): cannot overwrite property "'+n+'" of target object'}),t[n]=e[n]);return t},Z=function(t){return g(t)&&"union"===t.meta.kind},J=1;function X(t){return Object.keys(t).map(function(t){return h.stringify(t)}).join(" | ")}function G(t,e){h(y(t),function(){return"Invalid argument map "+h.stringify(t)+" supplied to enums(map, [name]) combinator (expected a dictionary of String -> String | Number)"}),h(I(e),function(){return"Invalid argument name "+h.stringify(e)+" supplied to enums(map, [name]) combinator (expected a string)"});var r=e||X(t);function n(e,i){return b(this,n),i=i||[r],h(n.is(e),function(){return"Invalid value "+h.stringify(e)+" supplied to "+i.join("/")+" (expected one of "+h.stringify(Object.keys(t))+")"}),e}return n.meta={kind:"enums",map:t,name:e,identity:!0},n.displayName=r,n.is=function(e){return t.hasOwnProperty(e)},n}G.of=function(t,e){t=m(t)?t.split(" "):t;var r={};return t.forEach(function(t){r[t]=t}),G(r,e)},G.getDefaultName=X;var K=G;function Q(t){return"Array<"+v(t)+">"}function W(t,e){h(s(t),function(){return"Invalid argument type "+h.stringify(t)+" supplied to list(type, [name]) combinator (expected a type)"}),h(I(e),function(){return"Invalid argument name "+h.stringify(e)+" supplied to list(type, [name]) combinator (expected a string)"});var r=e||Q(t),n=v(t),i=R(t);function o(e,i){i=i||[r],h(d(e),function(){return"Invalid value "+h.stringify(e)+" supplied to "+i.join("/")+" (expected an array of "+n+")"});for(var o=!0,a=[],s=0,u=e.length;u>s;s++){var c=e[s],p=C(t,c,i.concat(s+": "+n));o=o&&c===p,a.push(p)}return o&&(a=e),Object.freeze(a),a}return o.meta={kind:"list",type:t,name:e,identity:i},o.displayName=r,o.is=function(e){return d(e)&&e.every(function(e){return U(e,t)})},o.update=function(t,e){return o(h.update(t,e))},o}W.getDefaultName=Q;var tt=W,et=function(t){return g(t)&&"maybe"===t.meta.kind};function rt(t){return"?"+v(t)}function nt(t,e){if(et(t)||t===x||t===T)return t;h(s(t),function(){return"Invalid argument type "+h.stringify(t)+" supplied to maybe(type, [name]) combinator (expected a type)"}),h(I(e),function(){return"Invalid argument name "+h.stringify(e)+" supplied to maybe(type, [name]) combinator (expected a string)"});var r=e||rt(t),n=R(t);function i(e,r){return n&&b(this,i),T.is(e)?e:C(t,e,r)}return i.meta={kind:"maybe",type:t,name:e,identity:n},i.displayName=r,i.is=function(e){return T.is(e)||U(e,t)},i}nt.getDefaultName=rt;var it=nt;var ot=function(t){return"{"+Object.keys(t).map(function(e){return e+": "+v(t[e])}).join(", ")+"}"},at=function(t){return g(t)&&"struct"===t.meta.kind},st=function(t){return g(t)&&"interface"===t.meta.kind};function ut(t){return g(t)&&"subtype"===t.meta.kind}var ct=function(t){return{predicates:function t(e){return ut(e)?[e.meta.predicate].concat(t(e.meta.type)):[]}(t),unrefinedType:function t(e){return ut(e)?t(e.meta.type):e}(t)}};var pt=function(t,e,r){h(s(t),function(){return"Invalid argument combinator supplied to extend(combinator, mixins, options), expected a function"}),h(d(e),function(){return"Invalid argument mixins supplied to extend(combinator, mixins, options), expected an array"});var n={},i={},o=[],a={};e.forEach(function(t,e){var r,s=ct(t),u=s.unrefinedType;h(y(u)||at(u)||st(u),function(){return"Invalid argument mixins["+e+"] supplied to extend(combinator, mixins, options), expected an object, struct, interface or a refinement (of struct or interface)"}),Array.prototype.push.apply(o,s.predicates),H(n,y(r=u)?r:r.meta.props),H(i,u.prototype),H(a,function(t){return y(t)?null:t.meta.defaultProps}(u),!0)}),(r=t.getOptions(r)).defaultProps=H(a,r.defaultProps,!0);var u=function(t,e,r){var n=t.reduce(function(t,e){return z(t,e)},e);return r&&(n.displayName=r,n.meta.name=r),n}(o,t(n,{strict:r.strict,defaultProps:r.defaultProps}),r.name);return H(u.prototype,i),u};function ft(t){return"Struct"+ot(t)}function lt(t,e){return pt(mt,t,e)}function ht(t){return y(t)||(t=u(t)?{}:{name:t}),t.hasOwnProperty("strict")||(t.strict=mt.strict),t.hasOwnProperty("defaultProps")||(t.defaultProps={}),t}function mt(t,e){var r=(e=ht(e)).name,n=e.strict,i=e.defaultProps;h(Y(N,O).is(t),function(){return"Invalid argument props "+h.stringify(t)+" supplied to struct(props, [options]) combinator (expected a dictionary String -> Type)"}),h(I(r),function(){return"Invalid argument name "+h.stringify(r)+" supplied to struct(props, [options]) combinator (expected a string)"}),h(_(n),function(){return"Invalid argument strict "+h.stringify(n)+" supplied to struct(props, [options]) combinator (expected a boolean)"}),h(y(i),function(){return"Invalid argument defaultProps "+h.stringify(i)+" supplied to struct(props, [options]) combinator (expected an object)"});var o=r||ft(t);function a(e,r){if(a.is(e))return e;if(r=r||[o],h(y(e),function(){return"Invalid value "+h.stringify(e)+" supplied to "+r.join("/")+" (expected an object)"}),n)for(s in e)e.hasOwnProperty(s)&&h(t.hasOwnProperty(s),function(){return'Invalid additional prop "'+s+'" supplied to '+r.join("/")});if(!(this instanceof a))return new a(e,r);for(var s in t)if(t.hasOwnProperty(s)){var u=t[s],c=e[s];void 0===c&&(c=i[s]),this[s]=C(u,c,r.concat(s+": "+v(u)))}Object.freeze(this)}return a.meta={kind:"struct",props:t,name:r,identity:!1,strict:n,defaultProps:i},a.displayName=o,a.is=function(t){return t instanceof a},a.update=function(t,e){return new a(h.update(t,e))},a.extend=function(t,e){return lt([a].concat(t),e)},a}mt.strict=!1,mt.getOptions=ht,mt.getDefaultName=ft,mt.extend=lt;var dt=mt;function yt(t){return"["+t.map(v).join(", ")+"]"}function gt(t,e){h(d(t)&&t.every(s),function(){return"Invalid argument types "+h.stringify(t)+" supplied to tuple(types, [name]) combinator (expected an array of types)"}),h(I(e),function(){return"Invalid argument name "+h.stringify(e)+" supplied to tuple(types, [name]) combinator (expected a string)"});var r=e||yt(t),n=t.every(R);function i(e,n){n=n||[r],h(d(e)&&e.length===t.length,function(){return"Invalid value "+h.stringify(e)+" supplied to "+n.join("/")+" (expected an array of length "+t.length+")"});for(var i=!0,o=[],a=0,s=t.length;s>a;a++){var u=t[a],c=e[a],p=C(u,c,n.concat(a+": "+v(u)));i=i&&c===p,o.push(p)}return i&&(o=e),Object.freeze(o),o}return i.meta={kind:"tuple",types:t,name:e,identity:n},i.displayName=r,i.is=function(e){return d(e)&&e.length===t.length&&t.every(function(t,r){return U(e[r],t)})},i.update=function(t,e){return i(h.update(t,e))},i}gt.getDefaultName=yt;var vt=gt;function bt(t){return t.map(v).join(" | ")}function wt(t,e){h(d(t)&&t.every(s)&&t.length>=2,function(){return"Invalid argument types "+h.stringify(t)+" supplied to union(types, [name]) combinator (expected an array of at least 2 types)"}),h(I(e),function(){return"Invalid argument name "+h.stringify(e)+" supplied to union(types, [name]) combinator (expected a string)"});var r=e||bt(t),n=t.every(R);function i(t,e){var o=i.dispatch(t);return!o&&i.is(t)?t:(n&&b(this,i),e=e||[r],h(s(o),function(){return"Invalid value "+h.stringify(t)+" supplied to "+e.join("/")+" (no constructor returned by dispatch)"}),e[e.length-1]+="("+v(o)+")",C(o,t,e))}return i.meta={kind:"union",types:t,name:e,identity:n},i.displayName=r,i.is=function(e){return t.some(function(t){return U(e,t)})},i.dispatch=function(e){for(var r=0,n=t.length;n>r;r++){var i=t[r];if(Z(i)){var o=i.dispatch(e);if(!u(o))return o}else if(U(e,i))return i}},i.update=function(t,e){return i(h.update(t,e))},i}wt.getDefaultName=bt;var xt=wt;function kt(t,e){return"("+t.map(v).join(", ")+") => "+v(e)}function _t(t){return O.is(t)&&y(t.instrumentation)}function Et(t){for(var e=t.length,r=!1,n=e-1;n>=0;n--){var i=t[n];if(!g(i)||"maybe"!==i.meta.kind)return n+1;r=!0}return r?0:e}function At(t,e,r){t=d(t)?t:[t],h(tt(O).is(t),function(){return"Invalid argument domain "+h.stringify(t)+" supplied to func(domain, codomain, [name]) combinator (expected an array of types)"}),h(O.is(e),function(){return"Invalid argument codomain "+h.stringify(e)+" supplied to func(domain, codomain, [name]) combinator (expected a type)"}),h(I(r),function(){return"Invalid argument name "+h.stringify(r)+" supplied to func(domain, codomain, [name]) combinator (expected a string)"});var n=r||kt(t,e),i=t.length,o=Et(t);function a(t,e){return _t(t)?(e=e||[n],h(a.is(t),function(){return"Invalid value "+h.stringify(t)+" supplied to "+e.join("/")}),t):a.of(t)}return a.meta={kind:"func",domain:t,codomain:e,name:r,identity:!0},a.displayName=n,a.is=function(r){return _t(r)&&r.instrumentation.domain.length===i&&r.instrumentation.domain.every(function(e,r){return e===t[r]})&&r.instrumentation.codomain===e},a.of=function(r,s){if(h(O.is(r),function(){return"Invalid argument f supplied to func.of "+n+" (expected a function)"}),h(u(s)||_(s),function(){return"Invalid argument curried "+h.stringify(s)+" supplied to func.of "+n+" (expected a boolean)"}),a.is(r))return r;function p(){var a=Array.prototype.slice.call(arguments),u=a.length;if(vt(t.slice(0,s?u:Math.max(u,o)),"arguments of function "+n)(a),s&&i>u){h(u>0,"Invalid arguments.length = 0 for curried function "+n);var c=Function.prototype.bind.apply(r,[this].concat(a));return At(t.slice(u),e).of(c,!0)}return C(e,r.apply(this,a))}return p.instrumentation={domain:t,codomain:e,f:r},p.displayName=c(r),p},a}At.getDefaultName=kt,At.getOptionalArgumentsIndex=Et;var Pt=At,Ot=R;function Tt(t){return t.map(v).join(" & ")}function jt(t,e){h(d(t)&&t.every(s)&&t.length>=2,function(){return"Invalid argument types "+h.stringify(t)+" supplied to intersection(types, [name]) combinator (expected an array of at least 2 types)"}),h(I(e),function(){return"Invalid argument name "+h.stringify(e)+" supplied to intersection(types, [name]) combinator (expected a string)"});var r=e||Tt(t),n=t.every(Ot);function i(t,e){return n&&R(this,i),e=e||[r],h(i.is(t),function(){return"Invalid value "+h.stringify(t)+" supplied to "+e.join("/")}),t}return i.meta={kind:"intersection",types:t,name:e,identity:n},i.displayName=r,i.is=function(e){return t.every(function(t){return U(e,t)})},i.update=function(t,e){return i(h.update(t,e))},i}jt.getDefaultName=Tt;var St=jt;var It=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t};function Rt(t,e){return pt(Ut,t,e)}function Ct(t){return y(t)||(t=u(t)?{}:{name:t}),t.hasOwnProperty("strict")||(t.strict=Ut.strict),t}function Ut(t,e){var r=(e=Ct(e)).name,n=e.strict;h(Y(N,O).is(t),function(){return"Invalid argument props "+h.stringify(t)+" supplied to interface(props, [options]) combinator (expected a dictionary String -> Type)"}),h(I(r),function(){return"Invalid argument name "+h.stringify(r)+" supplied to interface(props, [options]) combinator (expected a string)"}),h(_(n),function(){return"Invalid argument strict "+h.stringify(n)+" supplied to struct(props, [options]) combinator (expected a boolean)"});var i=r||ot(t),o=Object.keys(t).map(function(e){return t[e]}).every(R);function a(e,r){if(r=r||[i],h(!u(e),function(){return"Invalid value "+e+" supplied to "+r.join("/")}),n)for(var a in e)h(t.hasOwnProperty(a),function(){return'Invalid additional prop "'+a+'" supplied to '+r.join("/")});var s=!0,c=o?{}:It({},e);for(var p in t){var f=t[p],l=e[p],m=C(f,l,r.concat(p+": "+v(f)));s=s&&l===m,c[p]=m}return s&&(c=e),Object.freeze(c),c}return a.meta={kind:"interface",props:t,name:r,identity:o,strict:n},a.displayName=i,a.is=function(e){if(u(e))return!1;if(n)for(var r in e)if(!t.hasOwnProperty(r))return!1;for(var i in t)if(!U(e[i],t[i]))return!1;return!0},a.update=function(t,e){return a(h.update(t,e))},a.extend=function(t,e){return Rt([a].concat(t),e)},a}Ut.strict=!1,Ut.getOptions=Ct,Ut.getDefaultName=ot,Ut.extend=Rt;var Ft=Ut;function Dt(t){return y(t)?t instanceof Date||t instanceof RegExp?t:It({},t):d(t)?t.concat():t}function zt(t){return Bt.commands.hasOwnProperty(t)}function qt(t){return Bt.commands[t]}function Bt(t,e){h(y(e),function(){return"Invalid argument patch "+h.stringify(e)+" supplied to function update(instance, patch): expected an object containing commands"});var r,n=t,i=!1;for(var o in e)e.hasOwnProperty(o)&&(zt(o)?(r=qt(o)(e[o],n))!==t?(i=!0,n=r):n=t:(n===t&&(n=Dt(t)),r=Bt(n[o],e[o]),i=i||r!==n[o],n[o]=r));return i?n:t}Bt.commands={$apply:function(t,e){return h(s(t),"Invalid argument f supplied to immutability helper { $apply: f } (expected a function)"),t(e)},$push:function(t,e){return h(d(t),"Invalid argument elements supplied to immutability helper { $push: elements } (expected an array)"),h(d(e),"Invalid value supplied to immutability helper $push (expected an array)"),t.length>0?e.concat(t):e},$remove:function(t,e){if(h(d(t),"Invalid argument keys supplied to immutability helper { $remove: keys } (expected an array)"),h(y(e),"Invalid value supplied to immutability helper $remove (expected an object)"),t.length>0){e=Dt(e);for(var r=0,n=t.length;n>r;r++)delete e[t[r]]}return e},$set:function(t){return t},$splice:function(t,e){return h(d(t)&&t.every(d),"Invalid argument splices supplied to immutability helper { $splice: splices } (expected an array of arrays)"),h(d(e),"Invalid value supplied to immutability helper $splice (expected an array)"),t.length>0?(e=Dt(e),t.reduce(function(t,e){return t.splice.apply(t,e),t},e)):e},$swap:function(t,e){if(h(y(t),"Invalid argument config supplied to immutability helper { $swap: config } (expected an object)"),h(j(t.from),"Invalid argument config.from supplied to immutability helper { $swap: config } (expected a number)"),h(j(t.to),"Invalid argument config.to supplied to immutability helper { $swap: config } (expected a number)"),h(d(e),"Invalid value supplied to immutability helper $swap (expected an array)"),t.from!==t.to){var r=(e=Dt(e))[t.to];e[t.to]=e[t.from],e[t.from]=r}return e},$unshift:function(t,e){return h(d(t),"Invalid argument elements supplied to immutability helper {$unshift: elements} (expected an array)"),h(d(e),"Invalid value supplied to immutability helper $unshift (expected an array)"),t.length>0?t.concat(e):e},$merge:function(t,e){var r=!1,n=Dt(e);for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i],r=r||n[i]!==e[i]);return r?n:e}};var $t=Bt;h.Any=x,h.Array=k,h.Boolean=E,h.Date=A,h.Error=P,h.Function=O,h.Nil=T,h.Number=S,h.Integer=q,h.IntegerT=h.Integer,h.Object=B,h.RegExp=$,h.String=N,h.Type=M,h.TypeT=h.Type,h.Arr=h.Array,h.Bool=h.Boolean,h.Dat=h.Date,h.Err=h.Error,h.Func=h.Function,h.Num=h.Number,h.Obj=h.Object,h.Re=h.RegExp,h.Str=h.String,h.dict=Y,h.declare=function(t){var e;function r(n,i){return h(!u(e),function(){return"Type declared but not defined, don't forget to call .define on every declared type"}),Z(e)&&h(e.dispatch===r.dispatch,function(){return"Please define the custom "+t+".dispatch function before calling "+t+".define()"}),e(n,i)}return h(I(t),function(){return"Invalid argument name "+t+" supplied to declare([name]) (expected a string)"}),r.define=function(n){return h(g(n),function(){return"Invalid argument type "+h.stringify(n)+" supplied to define(type) (expected a type)"}),h(u(e),function(){return"Declare.define(type) can only be invoked once"}),Z(n)&&r.hasOwnProperty("dispatch")&&(n.dispatch=r.dispatch),H(r,e=n,!0),t&&(e.displayName=r.displayName=t,r.meta.name=t),r.meta.identity=e.meta.identity,r.prototype=e.prototype,r},r.displayName=t||v(r)+"$"+J++,r.meta={identity:!1},r.prototype=null,r},h.enums=K,h.irreducible=w,h.list=tt,h.maybe=it,h.refinement=z,h.struct=dt,h.tuple=vt,h.union=xt,h.func=Pt,h.intersection=St,h.subtype=h.refinement,h.inter=Ft,h.interface=h.inter,h.assert=h,h.update=$t,h.mixin=H,h.isType=g,h.is=U,h.getTypeName=v,h.match=function(t){for(var e,r,n,i,o=1,a=arguments.length;a>o;)if(e=arguments[o],r=arguments[o+1],s(n=arguments[o+2])&&!g(n)?o+=3:(n=r,r=x.is,o+=2),i=(i||0)+1,h(g(e),function(){return"Invalid type in clause #"+i}),h(s(r),function(){return"Invalid guard in clause #"+i}),h(s(n),function(){return"Invalid block in clause #"+i}),e.is(t)&&r(t))return n(t);h.fail("Match error")};var Nt=h,Mt=Nt.stringify,Lt={},Vt=Nt.struct({message:Nt.Any,actual:Nt.Any,expected:Nt.Any,path:Nt.list(Nt.union([Nt.String,Nt.Number]))},"ValidationError");function Yt(t,e,r,n){return Nt.Function.is(e.getValidationErrorMessage)?e.getValidationErrorMessage(t,r,n):function(t,e,r){var n=Nt.getTypeName(e),i=r.length?"/"+r.join("/")+": "+n:n;return"Invalid value "+Mt(t)+" supplied to "+i}(t,e,r)}Vt.of=function(t,e,r,n){return new Vt({message:Yt(t,e,r,n),actual:t,expected:e,path:r})};var Ht=Nt.struct({errors:Nt.list(Vt),value:Nt.Any},"ValidationResult");function Zt(t,e,r){var n=Nt.Array.is(r=r||{})?r:r.path||[];return new Ht(Jt(t,e,n,r))}function Jt(t,e,r,n){return Nt.isType(e)?Xt[e.meta.kind](t,e,r,n):Xt.es6classes(t,e,r,n)}Ht.prototype.isValid=function(){return!this.errors.length},Ht.prototype.firstError=function(){return this.isValid()?null:this.errors[0]},Ht.prototype.toString=function(){return this.isValid()?"[ValidationResult, true, "+Mt(this.value)+"]":"[ValidationResult, false, ("+this.errors.map(function(t){return Mt(t.message)}).join(", ")+")]"};var Xt=Zt.validators={};Xt.es6classes=function(t,e,r,n){return{value:t,errors:t instanceof e?[]:[Vt.of(t,e,r,n.context)]}},Xt.irreducible=Xt.enums=function(t,e,r,n){return{value:t,errors:e.is(t)?[]:[Vt.of(t,e,r,n.context)]}},Xt.list=function(t,e,r,n){if(!Nt.Array.is(t))return{value:t,errors:[Vt.of(t,e,r,n.context)]};for(var i={value:[],errors:[]},o=0,a=t.length;a>o;o++){var s=Jt(t[o],e.meta.type,r.concat(o),n);i.value[o]=s.value,i.errors=i.errors.concat(s.errors)}return i},Xt.subtype=function(t,e,r,n){var i=Jt(t,e.meta.type,r,n);return i.errors.length?i:(e.meta.predicate(i.value)||(i.errors=[Vt.of(t,e,r,n.context)]),i)},Xt.maybe=function(t,e,r,n){return Nt.Nil.is(t)?{value:t,errors:[]}:Jt(t,e.meta.type,r,n)},Xt.struct=function(t,e,r,n){if(!Nt.Object.is(t))return{value:t,errors:[Vt.of(t,e,r,n.context)]};if(e.is(t))return{value:t,errors:[]};var i={value:{},errors:[]},o=e.meta.props,a=e.meta.defaultProps||Lt;for(var s in o)if(o.hasOwnProperty(s)){var u=t[s];void 0===u&&(u=a[s]);var c=Jt(u,o[s],r.concat(s),n);i.value[s]=c.value,i.errors=i.errors.concat(c.errors)}if(n.hasOwnProperty("strict")?n.strict:e.meta.strict)for(var p in t)t.hasOwnProperty(p)&&!o.hasOwnProperty(p)&&i.errors.push(Vt.of(t[p],Nt.Nil,r.concat(p),n.context));return i.errors.length||(i.value=new e(i.value)),i},Xt.tuple=function(t,e,r,n){var i=e.meta.types,o=i.length;if(!Nt.Array.is(t)||t.length>o)return{value:t,errors:[Vt.of(t,e,r,n.context)]};for(var a={value:[],errors:[]},s=0;o>s;s++){var u=Jt(t[s],i[s],r.concat(s),n);a.value[s]=u.value,a.errors=a.errors.concat(u.errors)}return a},Xt.dict=function(t,e,r,n){if(!Nt.Object.is(t))return{value:t,errors:[Vt.of(t,e,r,n.context)]};var i={value:{},errors:[]};for(var o in t)if(t.hasOwnProperty(o)){var a=r.concat(o),s=Jt(o,e.meta.domain,a,n),u=Jt(t[o],e.meta.codomain,a,n);i.value[o]=u.value,i.errors=i.errors.concat(s.errors,u.errors)}return i},Xt.union=function(t,e,r,n){var i=e.dispatch(t);return Nt.Function.is(i)?Jt(t,i,r.concat(e.meta.types.indexOf(i)),n):{value:t,errors:[Vt.of(t,e,r,n.context)]}},Xt.intersection=function(t,e,r,n){for(var i=e.meta.types,o=i.length,a={value:t,errors:[]},s=0,u=0;o>u;u++){"struct"===i[u].meta.kind&&s++;var c=Jt(t,i[u],r,n);a.errors=a.errors.concat(c.errors)}return s>1&&a.errors.push(Vt.of(t,e,r,n.context)),a},Xt.interface=function(t,e,r,n){if(!Nt.Object.is(t))return{value:t,errors:[Vt.of(t,e,r,n.context)]};var i={value:{},errors:[]},o=e.meta.props;for(var a in o){var s=Jt(t[a],o[a],r.concat(a),n);i.value[a]=s.value,i.errors=i.errors.concat(s.errors)}if(n.hasOwnProperty("strict")?n.strict:e.meta.strict)for(var u in t)o.hasOwnProperty(u)||Nt.Nil.is(t[u])||i.errors.push(Vt.of(t[u],Nt.Nil,r.concat(u),n.context));return i},Nt.mixin(Nt,{ValidationError:Vt,ValidationResult:Ht,validate:Zt});var Gt=Nt.Boolean,Kt=Nt.Function,Qt=Nt.Integer,Wt=Nt.Number,te=Nt.String,ee=Nt.enums,re=Nt.refinement,ne=Nt.union,ie=Nt.struct,oe=Nt.validate,ae=Nt.list,se="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function ue(t,e){return t(e={exports:{}},e.exports),e.exports}var ce=ue(function(t){function e(t){if(t)return function(t){for(var r in e.prototype)t[r]=e.prototype[r];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;n.length>i;i++)if((r=n[i])===e||r.fn===e){n.splice(i,1);break}return this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks["$"+t];if(r)for(var n=0,i=(r=r.slice(0)).length;i>n;++n)r[n].apply(this,e);return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}});var pe=function(t){return null!==t&&"object"===r(t)},fe=le;function le(t){if(t)return function(t){for(var e in le.prototype)t[e]=le.prototype[e];return t}(t)}le.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},le.prototype.parse=function(t){return this._parser=t,this},le.prototype.responseType=function(t){return this._responseType=t,this},le.prototype.serialize=function(t){return this._serializer=t,this},le.prototype.timeout=function(t){if(!t||"object"!==r(t))return this._timeout=t,this._responseTimeout=0,this;for(var e in t)switch(e){case"deadline":this._timeout=t.deadline;break;case"response":this._responseTimeout=t.response;break;default:console.warn("Unknown timeout option",e)}return this},le.prototype.retry=function(t,e){return 0!==arguments.length&&!0!==t||(t=1),t>0||(t=0),this._maxRetries=t,this._retries=0,this._retryCallback=e,this};var he=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];le.prototype._shouldRetry=function(t,e){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var r=this._retryCallback(t,e);if(!0===r)return!0;if(!1===r)return!1}catch(t){console.error(t)}if(e&&e.status&&e.status>=500&&501!=e.status)return!0;if(t){if(t.code&&~he.indexOf(t.code))return!0;if(t.timeout&&"ECONNABORTED"==t.code)return!0;if(t.crossDomain)return!0}return!1},le.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},le.prototype.then=function(t,e){if(!this._fullfilledPromise){var r=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(t,e){r.end(function(r,n){r?e(r):t(n)})})}return this._fullfilledPromise.then(t,e)},le.prototype.catch=function(t){return this.then(void 0,t)},le.prototype.use=function(t){return t(this),this},le.prototype.ok=function(t){if("function"!=typeof t)throw Error("Callback required");return this._okCallback=t,this},le.prototype._isResponseOK=function(t){return!!t&&(this._okCallback?this._okCallback(t):t.status>=200&&300>t.status)},le.prototype.getHeader=le.prototype.get=function(t){return this._header[t.toLowerCase()]},le.prototype.set=function(t,e){if(pe(t)){for(var r in t)this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},le.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},le.prototype.field=function(t,e){if(null==t)throw Error(".field(name, val) name can not be empty");if(this._data&&console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()"),pe(t)){for(var r in t)this.field(r,t[r]);return this}if(Array.isArray(e)){for(var n in e)this.field(t,e[n]);return this}if(null==e)throw Error(".field(name, val) val can not be empty");return"boolean"==typeof e&&(e=""+e),this._getFormData().append(t,e),this},le.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},le.prototype._auth=function(t,e,r,n){switch(r.type){case"basic":this.set("Authorization","Basic "+n(t+":"+e));break;case"auto":this.username=t,this.password=e;break;case"bearer":this.set("Authorization","Bearer "+t)}return this},le.prototype.withCredentials=function(t){return null==t&&(t=!0),this._withCredentials=t,this},le.prototype.redirects=function(t){return this._maxRedirects=t,this},le.prototype.maxResponseSize=function(t){if("number"!=typeof t)throw TypeError("Invalid argument");return this._maxResponseSize=t,this},le.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},le.prototype.send=function(t){var e=pe(t),r=this._header["content-type"];if(this._formData&&console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()"),e&&!this._data)Array.isArray(t)?this._data=[]:this._isHost(t)||(this._data={});else if(t&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(e&&pe(this._data))for(var n in t)this._data[n]=t[n];else"string"==typeof t?(r||this.type("form"),this._data="application/x-www-form-urlencoded"==(r=this._header["content-type"])?this._data?this._data+"&"+t:t:(this._data||"")+t):this._data=t;return!e||this._isHost(t)?this:(r||this.type("json"),this)},le.prototype.sortQuery=function(t){return this._sort=void 0===t||t,this},le.prototype._finalizeQueryString=function(){var t=this._query.join("&");if(t&&(this.url+=(0>this.url.indexOf("?")?"?":"&")+t),this._query.length=0,this._sort){var e=this.url.indexOf("?");if(e>=0){var r=this.url.substring(e+1).split("&");"function"==typeof this._sort?r.sort(this._sort):r.sort(),this.url=this.url.substring(0,e)+"?"+r.join("&")}}},le.prototype._appendQueryString=function(){console.trace("Unsupported")},le.prototype._timeoutError=function(t,e,r){if(!this._aborted){var n=Error(t+e+"ms exceeded");n.timeout=e,n.code="ECONNABORTED",n.errno=r,this.timedout=!0,this.abort(),this.callback(n)}},le.prototype._setTimeouts=function(){var t=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){t._timeoutError("Timeout of ",t._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){t._timeoutError("Response timeout of ",t._responseTimeout,"ETIMEDOUT")},this._responseTimeout))};var me=function(t){return t.split(/ *; */).shift()},de=function(t){return t.split(/ *; */).reduce(function(t,e){var r=e.split(/ *= */),n=r.shift(),i=r.shift();return n&&i&&(t[n]=i),t},{})},ye=function(t){return t.split(/ *, */).reduce(function(t,e){var r=e.split(/ *; */),n=r[0].slice(1,-1);return t[r[1].split(/ *= */)[1].slice(1,-1)]=n,t},{})},ge=ve;function ve(t){if(t)return function(t){for(var e in ve.prototype)t[e]=ve.prototype[e];return t}(t)}function be(){this._defaults=[]}ve.prototype.get=function(t){return this.header[t.toLowerCase()]},ve.prototype._setHeaderProperties=function(t){var e=t["content-type"]||"";this.type=me(e);var r=de(e);for(var n in r)this[n]=r[n];this.links={};try{t.link&&(this.links=ye(t.link))}catch(t){}},ve.prototype._setStatusProperties=function(t){var e=t/100|0;this.status=this.statusCode=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.redirect=3==e,this.clientError=4==e,this.serverError=5==e,this.error=(4==e||5==e)&&this.toError(),this.created=201==t,this.accepted=202==t,this.noContent=204==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.forbidden=403==t,this.notFound=404==t,this.unprocessableEntity=422==t},["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach(function(t){be.prototype[t]=function(){return this._defaults.push({fn:t,arguments:arguments}),this}}),be.prototype._setDefaults=function(t){this._defaults.forEach(function(e){t[e.fn].apply(t,e.arguments)})};var we=be,xe=ue(function(t,e){var n;function i(){}"undefined"!=typeof window?n=window:"undefined"!=typeof self?n=self:(console.warn("Using browser-only version of superagent in non-browser environment"),n=se);var o=e=t.exports=function(t,r){return"function"==typeof r?new e.Request("GET",t).end(r):1==arguments.length?new e.Request("GET",t):new e.Request(t,r)};e.Request=l,o.getXHR=function(){if(!(!n.XMLHttpRequest||n.location&&"file:"==n.location.protocol&&n.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}throw Error("Browser-only version of superagent could not find XHR")};var a="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};function s(t){if(!pe(t))return t;var e=[];for(var r in t)u(e,r,t[r]);return e.join("&")}function u(t,e,r){if(null!=r)if(Array.isArray(r))r.forEach(function(r){u(t,e,r)});else if(pe(r))for(var n in r)u(t,e+"["+n+"]",r[n]);else t.push(encodeURIComponent(e)+"="+encodeURIComponent(r));else null===r&&t.push(encodeURIComponent(e))}function c(t){for(var e,r,n={},i=t.split("&"),o=0,a=i.length;a>o;++o)-1==(r=(e=i[o]).indexOf("="))?n[decodeURIComponent(e)]="":n[decodeURIComponent(e.slice(0,r))]=decodeURIComponent(e.slice(r+1));return n}function p(t){return/[\/+]json($|[^-\w])/.test(t)}function f(t){this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var e=this.xhr.status;1223===e&&(e=204),this._setStatusProperties(e),this.header=this.headers=function(t){for(var e,r,n,i,o=t.split(/\r?\n/),s={},u=0,c=o.length;c>u;++u)-1!==(e=(r=o[u]).indexOf(":"))&&(n=r.slice(0,e).toLowerCase(),i=a(r.slice(e+1)),s[n]=i);return s}(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.body=null===this.text&&t._responseType?this.xhr.response:"HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function l(t,e){var r=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var t,e=null,n=null;try{n=new f(r)}catch(t){return(e=Error("Parser is unable to parse the response")).parse=!0,e.original=t,r.xhr?(e.rawResponse=void 0===r.xhr.responseType?r.xhr.responseText:r.xhr.response,e.status=r.xhr.status?r.xhr.status:null,e.statusCode=e.status):(e.rawResponse=null,e.status=null),r.callback(e)}r.emit("response",n);try{r._isResponseOK(n)||(t=Error(n.statusText||"Unsuccessful HTTP response"))}catch(e){t=e}t?(t.original=e,t.response=n,t.status=n.status,r.callback(t,n)):r.callback(null,n)})}function h(t,e,r){var n=o("DELETE",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n}o.serializeObject=s,o.parseString=c,o.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},o.serialize={"application/x-www-form-urlencoded":s,"application/json":JSON.stringify},o.parse={"application/x-www-form-urlencoded":c,"application/json":JSON.parse},ge(f.prototype),f.prototype._parseBody=function(t){var e=o.parse[this.type];return this.req._parser?this.req._parser(this,t):(!e&&p(this.type)&&(e=o.parse["application/json"]),e&&t&&(t.length||t instanceof Object)?e(t):null)},f.prototype.toError=function(){var t=this.req,e=t.method,r=t.url,n=Error("cannot "+e+" "+r+" ("+this.status+")");return n.status=this.status,n.method=e,n.url=r,n},o.Response=f,ce(l.prototype),fe(l.prototype),l.prototype.type=function(t){return this.set("Content-Type",o.types[t]||t),this},l.prototype.accept=function(t){return this.set("Accept",o.types[t]||t),this},l.prototype.auth=function(t,e,n){1===arguments.length&&(e=""),"object"===r(e)&&null!==e&&(n=e,e=""),n||(n={type:"function"==typeof btoa?"basic":"auto"});return this._auth(t,e,n,function(t){if("function"==typeof btoa)return btoa(t);throw Error("Cannot use basic auth, btoa is not a function")})},l.prototype.query=function(t){return"string"!=typeof t&&(t=s(t)),t&&this._query.push(t),this},l.prototype.attach=function(t,e,r){if(e){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(t,e,r||e.name)}return this},l.prototype._getFormData=function(){return this._formData||(this._formData=new n.FormData),this._formData},l.prototype.callback=function(t,e){if(this._shouldRetry(t,e))return this._retry();var r=this._callback;this.clearTimeout(),t&&(this._maxRetries&&(t.retries=this._retries-1),this.emit("error",t)),r(t,e)},l.prototype.crossDomainError=function(){var t=Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},l.prototype.buffer=l.prototype.ca=l.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},l.prototype.pipe=l.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},l.prototype._isHost=function(t){return t&&"object"===r(t)&&!Array.isArray(t)&&"[object Object]"!==Object.prototype.toString.call(t)},l.prototype.end=function(t){return this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=t||i,this._finalizeQueryString(),this._end()},l.prototype._end=function(){var t=this,e=this.xhr=o.getXHR(),r=this._formData||this._data;this._setTimeouts(),e.onreadystatechange=function(){var r=e.readyState;if(r>=2&&t._responseTimeoutTimer&&clearTimeout(t._responseTimeoutTimer),4==r){var n;try{n=e.status}catch(t){n=0}if(!n){if(t.timedout||t._aborted)return;return t.crossDomainError()}t.emit("end")}};var n=function(e,r){r.total>0&&(r.percent=r.loaded/r.total*100),r.direction=e,t.emit("progress",r)};if(this.hasListeners("progress"))try{e.onprogress=n.bind(null,"download"),e.upload&&(e.upload.onprogress=n.bind(null,"upload"))}catch(t){}try{this.username&&this.password?e.open(this.method,this.url,!0,this.username,this.password):e.open(this.method,this.url,!0)}catch(t){return this.callback(t)}if(this._withCredentials&&(e.withCredentials=!0),!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof r&&!this._isHost(r)){var i=this._header["content-type"],a=this._serializer||o.serialize[i?i.split(";")[0]:""];!a&&p(i)&&(a=o.serialize["application/json"]),a&&(r=a(r))}for(var s in this.header)null!=this.header[s]&&this.header.hasOwnProperty(s)&&e.setRequestHeader(s,this.header[s]);return this._responseType&&(e.responseType=this._responseType),this.emit("request",this),e.send(void 0!==r?r:null),this},o.agent=function(){return new we},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(t){we.prototype[t.toLowerCase()]=function(e,r){var n=new o.Request(t,e);return this._setDefaults(n),r&&n.end(r),n}}),we.prototype.del=we.prototype.delete,o.get=function(t,e,r){var n=o("GET",t);return"function"==typeof e&&(r=e,e=null),e&&n.query(e),r&&n.end(r),n},o.head=function(t,e,r){var n=o("HEAD",t);return"function"==typeof e&&(r=e,e=null),e&&n.query(e),r&&n.end(r),n},o.options=function(t,e,r){var n=o("OPTIONS",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},o.del=h,o.delete=h,o.patch=function(t,e,r){var n=o("PATCH",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},o.post=function(t,e,r){var n=o("POST",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},o.put=function(t,e,r){var n=o("PUT",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n}}),ke=xe.get,_e=xe.put,Ee=xe.delete,Ae=Object.freeze({default:xe,__moduleExports:xe,get:ke,post:xe.post,put:_e,delete:Ee,head:xe.head,Request:xe.Request}),Pe=function(t,e){return Ae[t](e).set("Filestack-Source","JS-2.0.3")},Oe=function(){return function(t,e,r,n){this.resolve=t,this.fn=e,this.self=r||null,this.args=n}}(),Te=function(){function t(){this._s1=[],this._s2=[]}return t.prototype.push=function(t){this._s1.push(t)},t.prototype.shift=function(){var t=this._s2;if(0===t.length){var e=this._s1;if(0===e.length)return;this._s1=t,t=this._s2=e.reverse()}return t.pop()},t.prototype.isEmpty=function(){return!this._s1.length&&!this._s2.length},t}();var je,Se,Ie=function(t,e){var n=new Te;function i(e,r,i){if(t){t--;var a=new Promise(function(t){t(e.apply(r,i))});return a.then(o,o),a}return new Promise(function(t){n.push(new Oe(t,e,r,i))})}function o(){if(t++,!n.isEmpty()){var e=n.shift();e.resolve(i(e.fn,e.self,e.args))}}if(void 0!==e&&"function"!=typeof e)throw new TypeError("Expected throat fn to be a function but got "+r(e));return function(){for(var t=[],r=0;arguments.length>r;r++)t[r]=arguments[r];return i(e,this,t)}},Re=function(t,e){var r=t;if(e){var n=/filestackapi.com|filestackcontent.com/i;Object.keys(n).forEach(function(t){r[t]=n[t].replace(n,e)})}return r},Ce=function(t,e,r){void 0===r&&(r={});var n=Object.keys(r),i=e.map(function(t){return t.name}),o=i.join(", ");return n.forEach(function(e){if(0>i.indexOf(e))throw Error(e+" is not a valid option for "+t+". Valid options are: "+o)}),e.forEach(function(t){var e=r[t.name];if("location"===t.name&&"string"==typeof e&&(e=e.toLowerCase()),void 0!==e){var n=oe(e,t.type);if(!n.isValid()){var i=n.firstError();if(i&&i.message)throw Error(i.message)}}}),n},Ue=function(t){var e=i({},t);return Object.keys(e).forEach(function(t){return!e[t]&&void 0!==e[t]&&delete e[t]}),e},Fe=function(t,e,r){var n=!1,i=!1;return function(){for(var o=[],a=0;arguments.length>a;a++)o[a]=arguments[a];i=!!r&&!n;var s=this;if(n||(n=!0,setTimeout(function(){if(n=!1,!r)return t.apply(s,o)},e)),i)return i=!1,t.apply(this,arguments)}},De=function(t,e,r,n){if(!e||"string"!=typeof e)throw Error("A valid Filestack handle is required for remove");if(!(t.policy&&t.signature||n&&n.policy&&n.signature))throw Error("Security policy and signature are required for remove");var i=t.urls.fileApiUrl+"/"+e,o={key:t.apikey,policy:n&&n.policy||t.policy,signature:n&&n.signature||t.signature};return r&&(o.skip_storage=!0),new Promise(function(t,e){Ee(i).query(o).end(function(r,n){r?e(r):t(n)})})};!function(t){t.get="get",t.head="head"}(je||(je={})),function(t){t.blob="blob",t.json="json"}(Se||(Se={}));var ze={$schema:"http://json-schema.org/draft-07/schema#",title:"Filestack Transformations",description:"Filestack transformations parameters",type:"object",additionalProperties:!1,definitions:{securityCallDef:{id:"/securityCallDef",type:"string",enum:["pick","read","stat","write","writeUrl","store","convert","remove","exif","runWorkflow"]},regionsDef:{id:"/regionsDef",type:"string",enum:["us-east-1","us-west-1","us-west-2","eu-west-1","eu-central-1","ap-northeast-1","ap-northeast-2","ap-southeast-1","ap-southeast-2","sa-east-1"]},locationsDef:{id:"/locationsDef",type:"string",enum:["s3","S3","rackspace","gcs","azure","dropbox"]},colorDef:{id:"colorDef",oneOf:[{type:"string",pattern:"^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$"},{type:"string",enum:["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fractal","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray0","gray1","gray2","gray3","gray4","gray5","gray6","gray7","gray8","gray9","gray10","gray11","gray12","gray13","gray14","gray15","gray16","gray17","gray18","gray19","gray20","gray21","gray22","gray23","gray24","gray25","gray26","gray27","gray28","gray29","gray30","gray31","gray32","gray33","gray34","gray35","gray36","gray37","gray38","gray39","gray40","gray41","gray42","gray43","gray44","gray45","gray46","gray47","gray48","gray49","gray50","gray51","gray52","gray53","gray54","gray55","gray56","gray57","gray58","gray59","gray60","gray61","gray62","gray63","gray64","gray65","gray66","gray67","gray68","gray69","gray70","gray71","gray72","gray73","gray74","gray75","gray76","gray77","gray78","gray79","gray80","gray81","gray82","gray83","gray84","gray85","gray86","gray87","gray88","gray89","gray90","gray91","gray92","gray93","gray94","gray95","gray96","gray97","gray98","gray99","gray100","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","none","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"]}]},pageFormatDef:{id:"/pageFormatDef",type:"string",enum:["a2","a3","a4","a5","b4","b5","letter","legal","tabloid"]},pageRangeDef:{id:"/pageRangeDef",type:"array",uniqueItems:!0,items:[{oneOf:[{type:"integer",minimum:1},{type:"string",pattern:"^(\\d+(?:-\\d+)?)$|^(-\\d+)$|^(\\d+-)$",errorMessage:'Param should be provided in one of the following formats: "1,2,3,5", "1-3", "1-", "-2" '}]}]},facesDef:{id:"/facesDef",oneOf:[{type:"string",enum:["all"]},{type:"integer",minimum:1,maximum:1e3},{type:"array",uniqueItems:!0,items:[{type:"integer",minimum:1,maximum:1e3}]}]},objectsDef:{id:"/objectsDef",type:"array",minItems:1,maxItems:50,items:[{type:"array",additionalItems:!1,minItems:4,items:[{type:"integer",minimum:0,maximum:1e4},{type:"integer",minimum:0,maximum:1e4},{type:"integer",minimum:1,maximum:1e4},{type:"integer",minimum:1,maximum:1e4}]}]},positionDef:{id:"/positionDef",default:["middle","center"],oneOf:[{type:"string",enum:["top","middle","bottom","left","center","right"]},{type:"array",uniqueItems:!0,additionalItems:!1,minItems:2,default:["middle","center"],items:[{type:"string",enum:["top","middle","bottom"]},{type:"string",enum:["left","center","right"]}]}]}},properties:{flip:{type:"boolean",additionalProperties:!1},no_metadata:{type:"boolean",additionalProperties:!1},compress:{additionalProperties:!1,oneOf:[{type:"boolean"},{type:"object",properties:{metadata:{type:"boolean",default:!1}}}]},flop:{type:"boolean",additionalProperties:!1},enchance:{type:"boolean",additionalProperties:!1},redeye:{type:"boolean",additionalProperties:!1},monochrome:{type:"boolean",additionalProperties:!1},negative:{type:"boolean",additionalProperties:!1},tags:{type:"boolean",additionalProperties:!1},sfw:{type:"boolean",additionalProperties:!1},imagesize:{type:"boolean",additionalProperties:!1},metadata:{type:"object",params:{type:"array",items:{type:"string",enum:["filename","mimetype","size","width","height","writeable","path","container","cloud","exif","source_url","md5","sha256","sha1","sha512"]},minItems:0,uniqueItems:!0,additionalItems:!1},additionalProperties:!1},resize:{type:"object",properties:{width:{type:"number",minimum:0,maximum:1e4},height:{type:"number",minimum:0,maximum:1e4},fit:{type:"string",enum:["clip","crop","scale","max"],default:"clip"},align:{$ref:"positionDef",default:"center"}},additionalProperties:!1,anyOf:[{required:["width"]},{required:["height"]}]},crop:{type:"object",properties:{dim:{type:"array",additionalItems:!1,minItems:4,items:[{type:"integer",minimum:0,maximum:1e5},{type:"integer",minimum:0,maximum:1e5},{type:"integer",minimum:1,maximum:1e5},{type:"integer",minimum:1,maximum:1e5}]}},required:["dim"]},rotate:{type:"object",properties:{deg:{oneOf:[{type:"string",enum:["exif"]},{type:"number",minimum:0,maximum:359}]},exif:{type:"boolean"},background:{$ref:"colorDef",default:"FFFFFFFF"}},additionalProperties:!1},detect_faces:{oneOf:[{type:"boolean"},{type:"object",properties:{maxsize:{type:"number",minimum:0,maximum:1e4,default:.35},minsize:{type:"number",minimum:0,maximum:1e4,default:.35},export:{type:"boolean"},color:{$ref:"colorDef",default:"000000FF"}},additionalProperties:!1}]},crop_faces:{oneOf:[{type:"boolean"},{type:"object",properties:{faces:{default:1,$ref:"facesDef"},width:{type:"number",minimum:1,maximum:1e4},height:{type:"number",minimum:1,maximum:1e4},maxsize:{type:"number",minimum:0,maximum:1e4,default:.35},minsize:{type:"number",minimum:0,maximum:1e4,default:.35},buffer:{type:"integer",minimum:0,maximum:1e4},mode:{type:"string",enum:["crop","thumb","fill"],default:"thumb"}},additionalProperties:!1}]},pixelate_faces:{oneOf:[{type:"boolean"},{type:"object",properties:{faces:{$ref:"facesDef",default:"all"},maxsize:{type:"number",minimum:0,maximum:1e4,default:.35},minsize:{type:"number",minimum:0,maximum:1e4,default:.35},buffer:{type:"integer",minimum:0,maximum:1e4},amount:{type:"integer",minimum:2,maximum:100,default:10},blur:{type:"number",minimum:0,maximum:20,default:4},type:{type:"string",enum:["rect","oval"],default:"rect"}},additionalProperties:!1}]},blur_faces:{oneOf:[{type:"boolean"},{type:"object",properties:{faces:{$ref:"facesDef",default:"all"},maxsize:{type:"number",minimum:0,maximum:1e4,default:.35},minsize:{type:"number",minimum:0,maximum:1e4,default:.35},buffer:{type:"integer",minimum:0,maximum:1e4},amount:{type:"number",minimum:0,maximum:10,default:10},blur:{type:"number",minimum:0,maximum:20,default:4},type:{type:"string",enum:["rect","oval"],default:"rect"}},additionalProperties:!1}]},rounded_corners:{oneOf:[{type:"boolean"},{type:"object",properties:{radius:{oneOf:[{type:"integer",minimum:1,maximum:1e4},{type:"string",enum:["max"]}]},blur:{type:"number",minimum:0,maximum:20,default:.3},background:{$ref:"colorDef"}},additionalProperties:!1}]},vignette:{oneOf:[{type:"boolean"},{type:"object",properties:{amount:{type:"integer",minimum:0,maximum:100,default:20},blurmode:{type:"string",enum:["gaussian","linear"],default:"gaussian"},background:{$ref:"colorDef"}},additionalProperties:!1}]},polaroid:{oneOf:[{type:"boolean"},{type:"object",properties:{rotate:{type:"integer",minimum:0,maximum:359},color:{$ref:"colorDef",default:"snow"},background:{$ref:"colorDef"}},additionalProperties:!1}]},torn_edges:{oneOf:[{type:"boolean"},{type:"object",properties:{spread:{type:"array",additionalItems:!1,minItems:2,items:[{type:"integer",minimum:1,maximum:1e4,default:1},{type:"integer",minimum:1,maximum:1e4,default:10}]},background:{$ref:"colorDef"}},additionalProperties:!1}]},shadow:{oneOf:[{type:"boolean"},{type:"object",properties:{blur:{type:"number",minimum:0,maximum:20,default:100},opacity:{type:"integer",minimum:0,maximum:100,default:60},vector:{type:"array",additionalItems:!1,minItems:2,items:[{type:"integer",minimum:-1e3,maximum:1e3,default:4},{type:"integer",minimum:-1e3,maximum:1e3,default:4}]},color:{$ref:"colorDef"},background:{$ref:"colorDef"}},additionalProperties:!1}]},circle:{oneOf:[{type:"boolean"},{type:"object",properties:{background:{$ref:"colorDef"}},additionalProperties:!1}]},border:{oneOf:[{type:"boolean"},{type:"object",properties:{color:{$ref:"colorDef"},background:{$ref:"colorDef"},width:{type:"integer",minimum:0,maximum:1e3}},additionalProperties:!1}]},sharpen:{oneOf:[{type:"boolean"},{type:"object",properties:{amount:{type:"integer",minimum:0,maximum:20,default:2}},additionalProperties:!1}]},blur:{oneOf:[{type:"boolean"},{type:"object",properties:{amount:{type:"integer",minimum:0,maximum:20,default:2}},additionalProperties:!1}]},blackwhite:{oneOf:[{type:"boolean"},{type:"object",properties:{threshold:{type:"integer",minimum:0,maximum:100,default:50}},additionalProperties:!1}]},sepia:{oneOf:[{type:"boolean"},{type:"object",properties:{tone:{type:"integer",minimum:0,maximum:100,default:80}},additionalProperties:!1}]},pixelate:{oneOf:[{type:"boolean"},{type:"object",properties:{amount:{type:"integer",minimum:2,maximum:100,default:2}},additionalProperties:!1}]},oil_paint:{oneOf:[{type:"boolean"},{type:"object",properties:{amount:{type:"integer",minimum:2,maximum:100,default:2}},additionalProperties:!1}]},modulate:{oneOf:[{type:"boolean"},{type:"object",properties:{brightness:{type:"integer",minimum:0,maximum:1e4,default:100},saturation:{type:"integer",minimum:0,maximum:1e4,default:100},hue:{type:"integer",minimum:0,maximum:359,default:0}},additionalProperties:!1}]},asci:{oneOf:[{type:"boolean"},{type:"object",properties:{foreground:{$ref:"colorDef",default:"000000FF"},background:{$ref:"colorDef",default:"FFFFFFFF"},colored:{type:"boolean",default:!1},size:{type:"integer",minimum:10,maximum:100,default:100},reverse:{type:"boolean",default:!1}},additionalProperties:!1}]},collage:{type:"object",properties:{files:{type:"array",additionalItems:!1,minItems:1,items:[{type:"string"}]},margin:{type:"integer",minimum:1,maximum:100,default:10},width:{type:"integer",minimum:0,maximum:1e4},height:{type:"integer",minimum:0,maximum:1e4},color:{$ref:"colorDef",default:"FFFFFFFF"},fit:{type:"string",enum:["auto","crop"]},autorotate:{type:"boolean",default:!1}},required:["width","height","files"],additionalProperties:!1},urlscreenshot:{oneOf:[{type:"boolean"},{type:"object",properties:{agent:{type:"string",enum:["desktop","mobile"],default:"desktop"},width:{type:"integer",minimum:1,maximum:1920,default:1024},height:{type:"integer",minimum:1,maximum:8e3,default:768},mode:{type:"string",enum:["all","window"],default:"all"},delay:{type:"integer",minimum:0,maximum:2e4,default:1e3},orientation:{type:"string",enum:["portrait","landscape"],default:"portrait"},device:{type:"string",default:""}},additionalProperties:!1}]},upscale:{oneOf:[{type:"boolean"},{type:"object",properties:{noise:{type:"string",enum:["none","low","medium","high"],default:"none"},upscale:{type:"boolean",default:!0},style:{type:"string",enum:["artwork","photo"],default:"photo"}},additionalProperties:!1}]},output:{type:"object",additionalProperties:!1,properties:{format:{type:"string",enum:["doc","docx","html","jpg","odp","ods","odt","pjpg","pdf","png","ppt","pptx","svg","txt","webp","xls","xlsx"]},page:{type:"integer",minimum:1,maximum:99999},density:{type:"integer",minimum:1,maximum:500},compress:{type:"boolean"},quality:{oneOf:[{type:"string",enum:["input"]},{type:"integer",minimum:1,maximum:100,default:95}]},secure:{type:"boolean",default:!1},docinfo:{type:"boolean",default:!1},strip:{type:"boolean",default:!1},colorspace:{type:"string",enum:["rgb","cmyk","input"],default:"rgb"},background:{$ref:"colorDef"},pageformat:{type:"string",enum:["a2","a3","a4","a5","b4","b5","letter","legal","tabloid"]},pageorientation:{type:"string",enum:["landscape","portrait"]}}},pjpg:{oneOf:[{type:"boolean"},{type:"object",additionalProperties:!1,properties:{quality:{type:"integer",minimum:0,maximum:100},metadata:{type:"boolean",default:!1}}}]},quality:{type:"object",additionalProperties:!1,properties:{value:{type:"integer",minimum:1,maximum:100}}},cache:{oneOf:[{type:"boolean"},{type:"object",properties:{expiry:{type:"integer"}}}]},video_convert:{type:"object",additionalProperties:!1,properties:{width:{type:"integer",minimum:1,maximum:4096},height:{type:"integer",minimum:1,maximum:4096},preset:{type:"string"},force:{type:"boolean"},title:{type:"string"},extname:{type:"string"},upscale:{type:"boolean"},aspect_mode:{type:"string",enum:["letterbox","pad","crop","preserve","constrain"],default:"letterbox"},audio_sample_rate:{type:"integer",minimum:1,maximum:99999},two_pass:{type:"boolean"},video_bitrate:{type:"integer",minimum:1,maximum:5e3},fps:{type:"integer",minimum:1,maximum:300},keyframe_interval:{type:"integer",minimum:250,maximum:250},audio_bitrate:{type:"integer",minimum:1,maximum:999},audio_channels:{type:"integer",minimum:1,maximum:12},clip_length:{type:"string",pattern:"^([0-1]?\\d|2[0-3])(?::([0-5]?\\d))?(?::([0-5]?\\d))?$"},clip_offset:{type:"string",pattern:"^([0-1]?\\d|2[0-3])(?::([0-5]?\\d))?(?::([0-5]?\\d))?$"},watermark_url:{type:"string"},watermark_top:{type:"integer",minimum:0,maximum:9999},watermark_right:{type:"integer",minimum:0,maximum:9999},watermark_bottom:{type:"integer",minimum:0,maximum:9999},watermark_left:{type:"integer",minimum:0,maximum:9999},frame_count:{type:"integer",minimum:1,maximum:1,default:1},filename:{type:"string"},location:{$ref:"locationsDef"},path:{type:"string"},container:{type:"string"},access:{type:"string",enum:["public","private"],default:"public"}}},store:{oneOf:[{type:"boolean"},{type:"object",additionalProperties:!1,properties:{filename:{type:"string"},location:{$ref:"locationsDef"},path:{type:"string"},container:{type:"string"},region:{$ref:"regionsDef"},access:{type:"string",enum:["public","private"],default:"private"},base64decode:{type:"boolean"},workflows:{type:"array",additionalItems:!1,minItems:1,maxItems:20,items:[{type:"string"},{type:"object",additionalProperties:!1,properties:{id:{type:"string"}}}]}}}]},watermark:{type:"object",properties:{file:{type:"string"},size:{type:"number",minimum:0,maximum:500},position:{$ref:"positionDef"}},required:["file"],additionalProperties:!1},partial_blur:{type:"object",properties:{objects:{$ref:"objectsDef"},amount:{type:"number",minimum:0,maximum:20},blur:{type:"number",minimum:0,maximum:20},type:{type:"string",enum:["rect","oval"]}},required:["objects"]},partial_pixelate:{type:"object",properties:{objects:{$ref:"objectsDef"},amount:{type:"number",minimum:2,maximum:100},blur:{type:"number",minimum:0,maximum:20},type:{type:"string",enum:["rect","oval"]}},required:["objects"]},security:{type:"object",additionalProperties:!1,properties:{policy:{type:"string"},signature:{type:"string"}},required:["policy","signature"]},pdfinfo:{oneOf:[{type:"boolean"},{type:"object",properties:{colorinfo:{type:"boolean"}}}]},pdfconvert:{type:"object",additionalProperties:!1,properties:{pageorientation:{type:"string",enum:["portrait","landscape"]},pageformat:{$ref:"pageFormatDef"},pages:{$ref:"pageRangeDef"}},anyOf:[{required:["pageorientation"]},{required:["pageformat"]},{required:["pages"]}]},fallback:{type:"object",additionalProperties:!1,properties:{handle:{type:"string"},cache:{type:"integer",minimum:1,maximum:31536e3}},required:["handle"]}}},qe=2147483647,Be=36,$e=1,Ne=26,Me=38,Le=700,Ve=72,Ye=128,He="-",Ze=/[^\x20-\x7E]/,Je=/[\x2E\u3002\uFF0E\uFF61]/g,Xe={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Ge=Be-$e,Ke=Math.floor,Qe=String.fromCharCode;function We(t){throw new RangeError(Xe[t])}function tr(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function er(t,e,r){var n=0;for(t=r?Ke(t/Le):t>>1,t+=Ke(t/e);t>Ge*Ne>>1;n+=Be)t=Ke(t/Ge);return Ke(n+(Ge+1)*t/(t+Me))}function rr(t){return function(t,e){var r=t.split("@"),n="";r.length>1&&(n=r[0]+"@",t=r[1]);var i=function(t,e){for(var r=t.length,n=[];r--;)n[r]=e(t[r]);return n}((t=t.replace(Je,".")).split("."),e).join(".");return n+i}(t,function(t){return Ze.test(t)?"xn--"+function(t){var e,r,n,i,o,a,s,u,c,p,f,l,h,m,d,y=[];for(l=(t=function(t){for(var e,r,n=[],i=0,o=t.length;o>i;)55296>(e=t.charCodeAt(i++))||e>56319||i>=o?n.push(e):56320==(64512&(r=t.charCodeAt(i++)))?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),i--);return n}(t)).length,e=Ye,r=0,o=Ve,a=0;l>a;++a)128>(f=t[a])&&y.push(Qe(f));for(n=i=y.length,i&&y.push(He);l>n;){for(s=qe,a=0;l>a;++a)(f=t[a])>=e&&s>f&&(s=f);for(s-e>Ke((qe-r)/(h=n+1))&&We("overflow"),r+=(s-e)*h,e=s,a=0;l>a;++a)if(e>(f=t[a])&&++r>qe&&We("overflow"),f==e){for(u=r,c=Be;(p=c>o?o+Ne>c?c-o:Ne:$e)<=u;c+=Be)y.push(Qe(tr(p+(d=u-p)%(m=Be-p),0))),u=Ke(d/m);y.push(Qe(tr(u,0))),o=er(r,h,n==i),r=0,++n}++r,++e}return y.join("")}(t):t})}var nr="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},ir=[],or=[],ar="undefined"!=typeof Uint8Array?Uint8Array:Array,sr=!1;function ur(){sr=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0;64>e;++e)ir[e]=t[e],or[t.charCodeAt(e)]=e;or[45]=62,or[95]=63}function cr(t,e,r){for(var n,i=[],o=e;r>o;o+=3)i.push(ir[(n=(t[o]<<16)+(t[o+1]<<8)+t[o+2])>>18&63]+ir[n>>12&63]+ir[n>>6&63]+ir[63&n]);return i.join("")}function pr(t){var e;sr||ur();for(var r=t.length,n=r%3,i="",o=[],a=0,s=r-n;s>a;a+=16383)o.push(cr(t,a,a+16383>s?s:a+16383));return 1===n?(i+=ir[(e=t[r-1])>>2],i+=ir[e<<4&63],i+="=="):2===n&&(i+=ir[(e=(t[r-2]<<8)+t[r-1])>>10],i+=ir[e>>4&63],i+=ir[e<<2&63],i+="="),o.push(i),o.join("")}function fr(t,e,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,c=u>>1,p=-7,f=r?i-1:0,l=r?-1:1,h=t[e+f];for(f+=l,o=h&(1<<-p)-1,h>>=-p,p+=s;p>0;o=256*o+t[e+f],f+=l,p-=8);for(a=o&(1<<-p)-1,o>>=-p,p+=n;p>0;a=256*a+t[e+f],f+=l,p-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,n),o-=c}return(h?-1:1)*a*Math.pow(2,o-n)}function lr(t,e,r,n,i,o){var a,s,u,c=8*o-i-1,p=(1<<c)-1,f=p>>1,l=23===i?5.960464477539062e-8:0,h=n?0:o-1,m=n?1:-1,d=0>e||0===e&&0>1/e?1:0;for(isNaN(e=Math.abs(e))||e===1/0?(s=isNaN(e)?1:0,a=p):(1>e*(u=Math.pow(2,-(a=Math.floor(Math.log(e)/Math.LN2))))&&(a--,u*=2),2>(e+=1>a+f?l*Math.pow(2,1-f):l/u)*u||(a++,u/=2),p>a+f?1>a+f?(s=e*Math.pow(2,f-1)*Math.pow(2,i),a=0):(s=(e*u-1)*Math.pow(2,i),a+=f):(s=0,a=p));i>=8;t[r+h]=255&s,h+=m,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[r+h]=255&a,h+=m,a/=256,c-=8);t[r+h-m]|=128*d}var hr={}.toString,mr=Array.isArray||function(t){return"[object Array]"==hr.call(t)};function dr(){return gr.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function yr(t,e){if(dr()<e)throw new RangeError("Invalid typed array length");return gr.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=gr.prototype:(null===t&&(t=new gr(e)),t.length=e),t}function gr(t,e,r){if(!(gr.TYPED_ARRAY_SUPPORT||this instanceof gr))return new gr(t,e,r);if("number"==typeof t){if("string"==typeof e)throw Error("If encoding is specified then the first argument must be a string");return wr(this,t)}return vr(this,t,e,r)}function vr(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(0>r||r>e.byteLength)throw new RangeError("'offset' is out of bounds");if(r+(n||0)>e.byteLength)throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);gr.TYPED_ARRAY_SUPPORT?(t=e).__proto__=gr.prototype:t=xr(t,e);return t}(t,e,r,n):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!gr.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|Er(e,r),i=(t=yr(t,n)).write(e,r);i!==n&&(t=t.slice(0,i));return t}(t,e,r):function(t,e){if(_r(e)){var r=0|kr(e.length);return 0===(t=yr(t,r)).length?t:(e.copy(t,0,0,r),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?yr(t,0):xr(t,e);if("Buffer"===e.type&&mr(e.data))return xr(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function br(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(0>t)throw new RangeError('"size" argument must not be negative')}function wr(t,e){if(br(e),t=yr(t,0>e?0:0|kr(e)),!gr.TYPED_ARRAY_SUPPORT)for(var r=0;e>r;++r)t[r]=0;return t}function xr(t,e){var r=0>e.length?0:0|kr(e.length);t=yr(t,r);for(var n=0;r>n;n+=1)t[n]=255&e[n];return t}function kr(t){if(t>=dr())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+dr().toString(16)+" bytes");return 0|t}function _r(t){return!(null==t||!t._isBuffer)}function Er(t,e){if(_r(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return Gr(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Kr(t).length;default:if(n)return Gr(t).length;e=(""+e).toLowerCase(),n=!0}}function Ar(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function Pr(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:-2147483648>r&&(r=-2147483648),isNaN(r=+r)&&(r=i?0:t.length-1),0>r&&(r=t.length+r),t.length>r){if(0>r){if(!i)return-1;r=0}}else{if(i)return-1;r=t.length-1}if("string"==typeof e&&(e=gr.from(e,n)),_r(e))return 0===e.length?-1:Or(t,e,r,n,i);if("number"==typeof e)return e&=255,gr.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):Or(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function Or(t,e,r,n,i){var o,a=1,s=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=(n+"").toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(2>t.length||2>e.length)return-1;a=2,s/=2,u/=2,r/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var p=-1;for(o=r;s>o;o++)if(c(t,o)===c(e,-1===p?0:o-p)){if(-1===p&&(p=o),o-p+1===u)return p*a}else-1!==p&&(o-=o-p),p=-1}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){for(var f=!0,l=0;u>l;l++)if(c(t,o+l)!==c(e,l)){f=!1;break}if(f)return o}return-1}function Tr(t,e,r,n){var i=t.length-(r=+r||0);n?(n=+n)>i&&(n=i):n=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;n>a;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[r+a]=s}return a}function jr(t,e,r,n){return Qr(Gr(e,t.length-r),t,r,n)}function Sr(t,e,r,n){return Qr(function(t){for(var e=[],r=0;t.length>r;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function Ir(t,e,r,n){return Sr(t,e,r,n)}function Rr(t,e,r,n){return Qr(Kr(e),t,r,n)}function Cr(t,e,r,n){return Qr(function(t,e){for(var r,n,i=[],o=0;t.length>o&&0<=(e-=2);++o)r=t.charCodeAt(o),n=r>>8,i.push(r%256),i.push(n);return i}(e,t.length-r),t,r,n)}function Ur(t,e,r){return pr(0===e&&r===t.length?t:t.slice(e,r))}function Fr(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;r>i;){var o,a,s,u,c=t[i],p=null,f=c>239?4:c>223?3:c>191?2:1;if(r>=i+f)switch(f){case 1:128>c&&(p=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(p=u);break;case 3:a=t[i+2],128==(192&(o=t[i+1]))&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(55296>u||u>57343)&&(p=u);break;case 4:a=t[i+2],s=t[i+3],128==(192&(o=t[i+1]))&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&1114112>u&&(p=u)}null===p?(p=65533,f=1):p>65535&&(n.push((p-=65536)>>>10&1023|55296),p=56320|1023&p),n.push(p),i+=f}return function(t){var e=t.length;if(Dr>=e)return String.fromCharCode.apply(String,t);var r="",n=0;for(;e>n;)r+=String.fromCharCode.apply(String,t.slice(n,n+=Dr));return r}(n)}gr.TYPED_ARRAY_SUPPORT=void 0===nr.TYPED_ARRAY_SUPPORT||nr.TYPED_ARRAY_SUPPORT,gr.poolSize=8192,gr._augment=function(t){return t.__proto__=gr.prototype,t},gr.from=function(t,e,r){return vr(null,t,e,r)},gr.TYPED_ARRAY_SUPPORT&&(gr.prototype.__proto__=Uint8Array.prototype,gr.__proto__=Uint8Array),gr.alloc=function(t,e,r){return function(t,e,r,n){return br(e),e>0&&void 0!==r?"string"==typeof n?yr(t,e).fill(r,n):yr(t,e).fill(r):yr(t,e)}(null,t,e,r)},gr.allocUnsafe=function(t){return wr(null,t)},gr.allocUnsafeSlow=function(t){return wr(null,t)},gr.isBuffer=function(t){return null!=t&&(!!t._isBuffer||Wr(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&Wr(t.slice(0,0))}(t))},gr.compare=function(t,e){if(!_r(t)||!_r(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);o>i;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return n>r?-1:r>n?1:0},gr.isEncoding=function(t){switch((t+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},gr.concat=function(t,e){if(!mr(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return gr.alloc(0);var r;if(void 0===e)for(e=0,r=0;t.length>r;++r)e+=t[r].length;var n=gr.allocUnsafe(e),i=0;for(r=0;t.length>r;++r){var o=t[r];if(!_r(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},gr.byteLength=Er,gr.prototype._isBuffer=!0,gr.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;t>e;e+=2)Ar(this,e,e+1);return this},gr.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;t>e;e+=4)Ar(this,e,e+3),Ar(this,e+1,e+2);return this},gr.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;t>e;e+=8)Ar(this,e,e+7),Ar(this,e+1,e+6),Ar(this,e+2,e+5),Ar(this,e+3,e+4);return this},gr.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Fr(this,0,t):function(t,e,r){var n=!1;if((void 0===e||0>e)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),0>=r)return"";if((e>>>=0)>=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return Br(this,e,r);case"utf8":case"utf-8":return Fr(this,e,r);case"ascii":return zr(this,e,r);case"latin1":case"binary":return qr(this,e,r);case"base64":return Ur(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $r(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},gr.prototype.equals=function(t){if(!_r(t))throw new TypeError("Argument must be a Buffer");return this===t||0===gr.compare(this,t)},gr.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},gr.prototype.compare=function(t,e,r,n,i){if(!_r(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),0>e||r>t.length||0>n||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0),s=Math.min(o,a),u=this.slice(n,i),c=t.slice(e,r),p=0;s>p;++p)if(u[p]!==c[p]){o=u[p],a=c[p];break}return a>o?-1:o>a?1:0},gr.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},gr.prototype.indexOf=function(t,e,r){return Pr(this,t,e,r,!0)},gr.prototype.lastIndexOf=function(t,e,r){return Pr(this,t,e,r,!1)},gr.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(0>r||0>e)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return Tr(this,t,e,r);case"utf8":case"utf-8":return jr(this,t,e,r);case"ascii":return Sr(this,t,e,r);case"latin1":case"binary":return Ir(this,t,e,r);case"base64":return Rr(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Cr(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},gr.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Dr=4096;function zr(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;++i)n+=String.fromCharCode(127&t[i]);return n}function qr(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;++i)n+=String.fromCharCode(t[i]);return n}function Br(t,e,r){var n=t.length;e&&e>=0||(e=0),(!r||0>r||r>n)&&(r=n);for(var i="",o=e;r>o;++o)i+=Xr(t[o]);return i}function $r(t,e,r){for(var n=t.slice(e,r),i="",o=0;n.length>o;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function Nr(t,e,r){if(t%1!=0||0>t)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function Mr(t,e,r,n,i,o){if(!_r(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||o>e)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function Lr(t,e,r,n){0>e&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);o>i;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function Vr(t,e,r,n){0>e&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);o>i;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function Yr(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(0>r)throw new RangeError("Index out of range")}function Hr(t,e,r,n,i){return i||Yr(t,0,r,4),lr(t,e,r,n,23,4),r+4}function Zr(t,e,r,n,i){return i||Yr(t,0,r,8),lr(t,e,r,n,52,8),r+8}gr.prototype.slice=function(t,e){var r,n=this.length;if(0>(t=~~t)?0>(t+=n)&&(t=0):t>n&&(t=n),0>(e=void 0===e?n:~~e)?0>(e+=n)&&(e=0):e>n&&(e=n),t>e&&(e=t),gr.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=gr.prototype;else{var i=e-t;r=new gr(i,void 0);for(var o=0;i>o;++o)r[o]=this[o+t]}return r},gr.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||Nr(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},gr.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||Nr(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},gr.prototype.readUInt8=function(t,e){return e||Nr(t,1,this.length),this[t]},gr.prototype.readUInt16LE=function(t,e){return e||Nr(t,2,this.length),this[t]|this[t+1]<<8},gr.prototype.readUInt16BE=function(t,e){return e||Nr(t,2,this.length),this[t]<<8|this[t+1]},gr.prototype.readUInt32LE=function(t,e){return e||Nr(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},gr.prototype.readUInt32BE=function(t,e){return e||Nr(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},gr.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||Nr(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return(i*=128)>n||(n-=Math.pow(2,8*e)),n},gr.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||Nr(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return(i*=128)>o||(o-=Math.pow(2,8*e)),o},gr.prototype.readInt8=function(t,e){return e||Nr(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},gr.prototype.readInt16LE=function(t,e){e||Nr(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},gr.prototype.readInt16BE=function(t,e){e||Nr(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},gr.prototype.readInt32LE=function(t,e){return e||Nr(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},gr.prototype.readInt32BE=function(t,e){return e||Nr(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},gr.prototype.readFloatLE=function(t,e){return e||Nr(t,4,this.length),fr(this,t,!0,23,4)},gr.prototype.readFloatBE=function(t,e){return e||Nr(t,4,this.length),fr(this,t,!1,23,4)},gr.prototype.readDoubleLE=function(t,e){return e||Nr(t,8,this.length),fr(this,t,!0,52,8)},gr.prototype.readDoubleBE=function(t,e){return e||Nr(t,8,this.length),fr(this,t,!1,52,8)},gr.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||Mr(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},gr.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||Mr(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},gr.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||Mr(this,t,e,1,255,0),gr.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},gr.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||Mr(this,t,e,2,65535,0),gr.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Lr(this,t,e,!0),e+2},gr.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||Mr(this,t,e,2,65535,0),gr.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Lr(this,t,e,!1),e+2},gr.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||Mr(this,t,e,4,4294967295,0),gr.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):Vr(this,t,e,!0),e+4},gr.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||Mr(this,t,e,4,4294967295,0),gr.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Vr(this,t,e,!1),e+4},gr.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);Mr(this,t,e,r,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<r&&(a*=256);)0>t&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+r},gr.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);Mr(this,t,e,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)0>t&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+r},gr.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||Mr(this,t,e,1,127,-128),gr.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[e]=255&t,e+1},gr.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||Mr(this,t,e,2,32767,-32768),gr.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Lr(this,t,e,!0),e+2},gr.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||Mr(this,t,e,2,32767,-32768),gr.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Lr(this,t,e,!1),e+2},gr.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||Mr(this,t,e,4,2147483647,-2147483648),gr.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):Vr(this,t,e,!0),e+4},gr.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||Mr(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),gr.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Vr(this,t,e,!1),e+4},gr.prototype.writeFloatLE=function(t,e,r){return Hr(this,t,e,!0,r)},gr.prototype.writeFloatBE=function(t,e,r){return Hr(this,t,e,!1,r)},gr.prototype.writeDoubleLE=function(t,e,r){return Zr(this,t,e,!0,r)},gr.prototype.writeDoubleBE=function(t,e,r){return Zr(this,t,e,!1,r)},gr.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),t.length>e||(e=t.length),e||(e=0),n>0&&r>n&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(0>e)throw new RangeError("targetStart out of bounds");if(0>r||r>=this.length)throw new RangeError("sourceStart out of bounds");if(0>n)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),n-r>t.length-e&&(n=t.length-e+r);var i,o=n-r;if(this===t&&e>r&&n>e)for(i=o-1;i>=0;--i)t[i+e]=this[i+r];else if(1e3>o||!gr.TYPED_ARRAY_SUPPORT)for(i=0;o>i;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+o),e);return o},gr.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var i=t.charCodeAt(0);256>i&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!gr.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(0>e||e>this.length||r>this.length)throw new RangeError("Out of range index");if(e>=r)return this;var o;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(o=e;r>o;++o)this[o]=t;else{var a=_r(t)?t:Gr(""+new gr(t,n)),s=a.length;for(o=0;r-e>o;++o)this[o+e]=a[o%s]}return this};var Jr=/[^+\/0-9A-Za-z-_]/g;function Xr(t){return 16>t?"0"+t.toString(16):t.toString(16)}function Gr(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],a=0;n>a;++a){if((r=t.charCodeAt(a))>55295&&57344>r){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(56320>r){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,128>r){if(0>(e-=1))break;o.push(r)}else if(2048>r){if(0>(e-=2))break;o.push(r>>6|192,63&r|128)}else if(65536>r){if(0>(e-=3))break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(r>=1114112)throw Error("Invalid code point");if(0>(e-=4))break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function Kr(t){return function(t){var e,r,n,i,o,a;sr||ur();var s=t.length;if(s%4>0)throw Error("Invalid string. Length must be a multiple of 4");a=new ar(3*s/4-(o="="===t[s-2]?2:"="===t[s-1]?1:0)),n=o>0?s-4:s;var u=0;for(e=0,r=0;n>e;e+=4,r+=3)i=or[t.charCodeAt(e)]<<18|or[t.charCodeAt(e+1)]<<12|or[t.charCodeAt(e+2)]<<6|or[t.charCodeAt(e+3)],a[u++]=i>>16&255,a[u++]=i>>8&255,a[u++]=255&i;return 2===o?(i=or[t.charCodeAt(e)]<<2|or[t.charCodeAt(e+1)]>>4,a[u++]=255&i):1===o&&(i=or[t.charCodeAt(e)]<<10|or[t.charCodeAt(e+1)]<<4|or[t.charCodeAt(e+2)]>>2,a[u++]=i>>8&255,a[u++]=255&i),a}(function(t){if(2>(t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(Jr,"")).length)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Qr(t,e,r,n){for(var i=0;n>i&&(i+r<e.length&&i<t.length);++i)e[i+r]=t[i];return i}function Wr(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function tn(t){return null===t}function en(t){return"string"==typeof t}function rn(t){return"object"===r(t)&&null!==t}function nn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var on=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function an(t){switch(r(t)){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}function sn(t,e){if(t.map)return t.map(e);for(var r=[],n=0;t.length>n;n++)r.push(e(t[n],n));return r}var un=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e};function cn(t,e,r,n){r=r||"=";var i={};if("string"!=typeof t||0===t.length)return i;var o=/\+/g;t=t.split(e=e||"&");var a=1e3;n&&"number"==typeof n.maxKeys&&(a=n.maxKeys);var s=t.length;a>0&&s>a&&(s=a);for(var u=0;s>u;++u){var c,p,f,l,h=t[u].replace(o,"%20"),m=h.indexOf(r);0>m?(c=h,p=""):(c=h.substr(0,m),p=h.substr(m+1)),f=decodeURIComponent(c),l=decodeURIComponent(p),nn(i,f)?on(i[f])?i[f].push(l):i[f]=[i[f],l]:i[f]=l}return i}var pn={parse:An,resolve:function(t,e){return An(t,!1,!0).resolve(e)},resolveObject:function(t,e){return t?An(t,!1,!0).resolveObject(e):e},format:function(t){en(t)&&(t=Pn({},t));return On(t)},Url:fn};function fn(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var ln=/^([a-z0-9.+-]+:)/i,hn=/:[0-9]*$/,mn=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,dn=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),yn=["'"].concat(dn),gn=["%","/","?",";","#"].concat(yn),vn=["/","?","#"],bn=255,wn=/^[+a-z0-9A-Z_-]{0,63}$/,xn=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,kn={javascript:!0,"javascript:":!0},_n={javascript:!0,"javascript:":!0},En={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function An(t,e,r){if(t&&rn(t)&&t instanceof fn)return t;var n=new fn;return n.parse(t,e,r),n}function Pn(t,e,n,i){if(!en(e))throw new TypeError("Parameter 'url' must be a string, not "+r(e));var o=e.indexOf("?"),a=-1!==o&&o<e.indexOf("#")?"?":"#",s=e.split(a);s[0]=s[0].replace(/\\/g,"/");var u=e=s.join(a);if(u=u.trim(),!i&&1===e.split("#").length){var c=mn.exec(u);if(c)return t.path=u,t.href=u,t.pathname=c[1],c[2]?(t.search=c[2],t.query=n?cn(t.search.substr(1)):t.search.substr(1)):n&&(t.search="",t.query={}),t}var p,f,l,h=ln.exec(u);if(h){var m=(h=h[0]).toLowerCase();t.protocol=m,u=u.substr(h.length)}if(i||h||u.match(/^\/\/[^@\/]+@[^@\/]+/)){var d="//"===u.substr(0,2);!d||h&&_n[h]||(u=u.substr(2),t.slashes=!0)}if(!_n[h]&&(d||h&&!En[h])){var y,g,v=-1;for(p=0;vn.length>p;p++)-1===(f=u.indexOf(vn[p]))||-1!==v&&f>=v||(v=f);for(-1!==(g=-1===v?u.lastIndexOf("@"):u.lastIndexOf("@",v))&&(y=u.slice(0,g),u=u.slice(g+1),t.auth=decodeURIComponent(y)),v=-1,p=0;gn.length>p;p++)-1===(f=u.indexOf(gn[p]))||-1!==v&&f>=v||(v=f);-1===v&&(v=u.length),t.host=u.slice(0,v),u=u.slice(v),Tn(t),t.hostname=t.hostname||"";var b="["===t.hostname[0]&&"]"===t.hostname[t.hostname.length-1];if(!b){var w=t.hostname.split(/\./);for(p=0,l=w.length;l>p;p++){var x=w[p];if(x&&!x.match(wn)){for(var k="",_=0,E=x.length;E>_;_++)x.charCodeAt(_)>127?k+="x":k+=x[_];if(!k.match(wn)){var A=w.slice(0,p),P=w.slice(p+1),O=x.match(xn);O&&(A.push(O[1]),P.unshift(O[2])),P.length&&(u="/"+P.join(".")+u),t.hostname=A.join(".");break}}}}t.hostname=t.hostname.length>bn?"":t.hostname.toLowerCase(),b||(t.hostname=rr(t.hostname)),t.host=(t.hostname||"")+(t.port?":"+t.port:""),t.href+=t.host,b&&(t.hostname=t.hostname.substr(1,t.hostname.length-2),"/"!==u[0]&&(u="/"+u))}if(!kn[m])for(p=0,l=yn.length;l>p;p++){var T=yn[p];if(-1!==u.indexOf(T)){var j=encodeURIComponent(T);j===T&&(j=escape(T)),u=u.split(T).join(j)}}var S=u.indexOf("#");-1!==S&&(t.hash=u.substr(S),u=u.slice(0,S));var I=u.indexOf("?");(-1!==I?(t.search=u.substr(I),t.query=u.substr(I+1),n&&(t.query=cn(t.query)),u=u.slice(0,I)):n&&(t.search="",t.query={}),u&&(t.pathname=u),En[m]&&t.hostname&&!t.pathname&&(t.pathname="/"),t.pathname||t.search)&&(t.path=(t.pathname||"")+(t.search||""));return t.href=On(t),t}function On(t){var e=t.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var n,i,o,a,s=t.protocol||"",u=t.pathname||"",c=t.hash||"",p=!1,f="";t.host?p=e+t.host:t.hostname&&(p=e+(-1===t.hostname.indexOf(":")?t.hostname:"["+this.hostname+"]"),t.port&&(p+=":"+t.port)),t.query&&rn(t.query)&&Object.keys(t.query).length&&(i=i||"&",o=o||"=",null===(n=t.query)&&(n=void 0),f="object"===r(n)?sn(un(n),function(t){var e=encodeURIComponent(an(t))+o;return on(n[t])?sn(n[t],function(t){return e+encodeURIComponent(an(t))}).join(i):e+encodeURIComponent(an(n[t]))}).join(i):a?encodeURIComponent(an(a))+o+encodeURIComponent(an(n)):"");var l=t.search||f&&"?"+f||"";return s&&":"!==s.substr(-1)&&(s+=":"),t.slashes||(!s||En[s])&&!1!==p?(p="//"+(p||""),u&&"/"!==u.charAt(0)&&(u="/"+u)):p||(p=""),c&&"#"!==c.charAt(0)&&(c="#"+c),l&&"?"!==l.charAt(0)&&(l="?"+l),s+p+(u=u.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(l=l.replace("#","%23"))+c}function Tn(t){var e=t.host,r=hn.exec(e);r&&(":"!==(r=r[0])&&(t.port=r.substr(1)),e=e.substr(0,e.length-r.length)),e&&(t.hostname=e)}fn.prototype.parse=function(t,e,r){return Pn(this,t,e,r)},fn.prototype.format=function(){return On(this)},fn.prototype.resolve=function(t){return this.resolveObject(An(t,!1,!0)).format()},fn.prototype.resolveObject=function(t){if(en(t)){var e=new fn;e.parse(t,!1,!0),t=e}for(var r,n=new fn,i=Object.keys(this),o=0;i.length>o;o++){var a=i[o];n[a]=this[a]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var s=Object.keys(t),u=0;s.length>u;u++){var c=s[u];"protocol"!==c&&(n[c]=t[c])}return En[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!En[t.protocol]){for(var p=Object.keys(t),f=0;p.length>f;f++){var l=p[f];n[l]=t[l]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||_n[t.protocol])n.pathname=t.pathname;else{for(r=(t.pathname||"").split("/");r.length&&!(t.host=r.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==r[0]&&r.unshift(""),2>r.length&&r.unshift(""),n.pathname=r.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search)n.path=(n.pathname||"")+(n.search||"");return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var h,m=n.pathname&&"/"===n.pathname.charAt(0),d=t.host||t.pathname&&"/"===t.pathname.charAt(0),y=d||m||n.host&&t.pathname,g=y,v=n.pathname&&n.pathname.split("/")||[],b=n.protocol&&!En[n.protocol];if(r=t.pathname&&t.pathname.split("/")||[],b&&(n.hostname="",n.port=null,n.host&&(""===v[0]?v[0]=n.host:v.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===r[0]?r[0]=t.host:r.unshift(t.host)),t.host=null),y=y&&(""===r[0]||""===v[0])),d)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,v=r;else if(r.length)v||(v=[]),v.pop(),v=v.concat(r),n.search=t.search,n.query=t.query;else if(null!=t.search)return b&&(n.hostname=n.host=v.shift(),(h=!(!n.host||0>=n.host.indexOf("@"))&&n.host.split("@"))&&(n.auth=h.shift(),n.host=n.hostname=h.shift())),n.search=t.search,n.query=t.query,tn(n.pathname)&&tn(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!v.length)return n.pathname=null,n.path=n.search?"/"+n.search:null,n.href=n.format(),n;for(var w=v.slice(-1)[0],x=(n.host||t.host||v.length>1)&&("."===w||".."===w)||""===w,k=0,_=v.length;_>=0;_--)"."===(w=v[_])?v.splice(_,1):".."===w?(v.splice(_,1),k++):k&&(v.splice(_,1),k--);if(!y&&!g)for(;k--;k)v.unshift("..");!y||""===v[0]||v[0]&&"/"===v[0].charAt(0)||v.unshift(""),x&&"/"!==v.join("/").substr(-1)&&v.push("");var E=""===v[0]||v[0]&&"/"===v[0].charAt(0);return b&&(n.hostname=n.host=E?"":v.length?v.shift():"",(h=!(!n.host||0>=n.host.indexOf("@"))&&n.host.split("@"))&&(n.auth=h.shift(),n.host=n.hostname=h.shift())),(y=y||n.host&&v.length)&&!E&&v.unshift(""),v.length?n.pathname=v.join("/"):(n.pathname=null,n.path=null),tn(n.pathname)&&tn(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},fn.prototype.parseHost=function(){return Tn(this)};var jn=ue(function(t,e){var n=e.ValidationError=function(t,e,r,n,i,o){n&&(this.property=n),t&&(this.message=t),r&&(this.schema=r.id?r.id:r),e&&(this.instance=e),this.name=i,this.argument=o,this.stack=""+this};n.prototype.toString=function(){return this.property+" "+this.message};var i=e.ValidatorResult=function(t,e,r,n){this.instance=t,this.schema=e,this.propertyPath=n.propertyPath,this.errors=[],this.throwError=r&&r.throwError,this.disableFormat=r&&!0===r.disableFormat};function o(t,e){return e+": "+t+"\n"}i.prototype.addError=function(t){var e;if("string"==typeof t)e=new n(t,this.instance,this.schema,this.propertyPath);else{if(!t)throw Error("Missing error detail");if(!t.message)throw Error("Missing error message");if(!t.name)throw Error("Missing validator type");e=new n(t.message,this.instance,this.schema,this.propertyPath,t.name,t.argument)}if(this.throwError)throw e;return this.errors.push(e),e},i.prototype.importErrors=function(t){"string"==typeof t||t&&t.validatorType?this.addError(t):t&&t.errors&&Array.prototype.push.apply(this.errors,t.errors)},i.prototype.toString=function(t){return this.errors.map(o).join("")},Object.defineProperty(i.prototype,"valid",{get:function(){return!this.errors.length}});var a=e.SchemaError=function t(e,r){this.message=e,this.schema=r,Error.call(this,e),Error.captureStackTrace(this,t)};a.prototype=Object.create(Error.prototype,{constructor:{value:a,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var s=e.SchemaContext=function(t,e,r,n,i){this.schema=t,this.options=e,this.propertyPath=r,this.base=n,this.schemas=i};s.prototype.resolve=function(t){return pn.resolve(this.base,t)},s.prototype.makeChild=function(t,e){var r=void 0===e?this.propertyPath:this.propertyPath+c(e),n=pn.resolve(this.base,t.id||""),i=new s(t,this.options,r,n,Object.create(this.schemas));return t.id&&!i.schemas[n]&&(i.schemas[n]=t),i};var u=e.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+-.]*:[^\s]*$/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,"utc-millisec":function(t){return"string"==typeof t&&parseFloat(t)===parseInt(t,10)&&!isNaN(t)},regex:function(t){var e=!0;return e},style:/\s*(.+?):\s*([^;]+);?/g,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/};u.regexp=u.regex,u.pattern=u.regex,u.ipv4=u["ip-address"],e.isFormat=function(t,e,r){if("string"==typeof t&&void 0!==u[e]){if(u[e]instanceof RegExp)return u[e].test(t);if("function"==typeof u[e])return u[e](t)}else if(r&&r.customFormats&&"function"==typeof r.customFormats[e])return r.customFormats[e](t);return!0};var c=e.makeSuffix=function(t){return(t=""+t).match(/[.\s\[\]]/)||t.match(/^[\d]/)?t.match(/^\d+$/)?"["+t+"]":"["+JSON.stringify(t)+"]":"."+t};function p(t,e){var n=Array.isArray(e),i=n&&[]||{};return n?(i=i.concat(t=t||[]),e.forEach(function(t,e,n,i){"object"===r(n)?e[i]=p(t[i],n):-1===t.indexOf(n)&&e.push(n)}.bind(null,t,i))):(t&&"object"===r(t)&&Object.keys(t).forEach(function(t,e,r){e[r]=t[r]}.bind(null,t,i)),Object.keys(e).forEach(function(t,e,n,i){n[i]="object"===r(e[i])&&e[i]&&t[i]?p(t[i],e[i]):e[i]}.bind(null,t,e,i))),i}function f(t){return"/"+encodeURIComponent(t).replace(/~/g,"%7E")}e.deepCompareStrict=function t(e,n){if(r(e)!==r(n))return!1;if(e instanceof Array)return n instanceof Array&&(e.length===n.length&&e.every(function(r,i){return t(e[i],n[i])}));if("object"===r(e)){if(!e||!n)return e===n;var i=Object.keys(e);return i.length===Object.keys(n).length&&i.every(function(r){return t(e[r],n[r])})}return e===n},t.exports.deepMerge=p,e.objectGetPath=function(t,e){for(var r,n=e.split("/").slice(1);"string"==typeof(r=n.shift());){var i=decodeURIComponent(r.replace(/~0/,"~").replace(/~1/g,"/"));if(!(i in t))return;t=t[i]}return t},e.encodePath=function(t){return t.map(f).join("")},e.getDecimalPlaces=function(t){var e=0;if(isNaN(t))return e;"number"!=typeof t&&(t=+t);var r=(""+t).split("e");if(2===r.length){if("-"!==r[1][0])return e;e=+r[1].slice(1)}var n=r[0].split(".");return 2===n.length&&(e+=n[1].length),e}}),Sn=jn.ValidatorResult,In=jn.SchemaError,Rn={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,exclusiveMinimum:!0,exclusiveMaximum:!0,additionalItems:!0,$schema:!0,$ref:!0,extends:!0}},Cn=Rn.validators={};function Un(t,e,r,n,i){var o=e.throwError;e.throwError=!1;var a=this.validateSchema(t,i,e,r);return e.throwError=o,!a.valid&&n instanceof Function&&n(a),a.valid}function Fn(t,e,r,n,i,o){if(this.types.object(t)&&(!e.properties||void 0===e.properties[i]))if(!1===e.additionalProperties)o.addError({name:"additionalProperties",argument:i,message:"additionalProperty "+JSON.stringify(i)+" exists in instance when not allowed"});else{var a=e.additionalProperties||{};"function"==typeof r.preValidateProperty&&r.preValidateProperty(t,i,a,r,n);var s=this.validateSchema(t[i],a,r,n.makeChild(a,i));s.instance!==o.instance[i]&&(o.instance[i]=s.instance),o.importErrors(s)}}Cn.type=function(t,e,r,n){if(void 0===t)return null;var i=new Sn(t,e,r,n),o=Array.isArray(e.type)?e.type:[e.type];if(!o.some(this.testType.bind(this,t,e,r,n))){var a=o.map(function(t){return t.id&&"<"+t.id+">"||t+""});i.addError({name:"type",argument:a,message:"is not of a type(s) "+a})}return i},Cn.anyOf=function(t,e,r,n){if(void 0===t)return null;var i=new Sn(t,e,r,n),o=new Sn(t,e,r,n);if(!Array.isArray(e.anyOf))throw new In("anyOf must be an array");if(!e.anyOf.some(Un.bind(this,t,r,n,function(t){o.importErrors(t)}))){var a=e.anyOf.map(function(t,e){return t.id&&"<"+t.id+">"||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+e+"]"});r.nestedErrors&&i.importErrors(o),i.addError({name:"anyOf",argument:a,message:"is not any of "+a.join(",")})}return i},Cn.allOf=function(t,e,r,n){if(void 0===t)return null;if(!Array.isArray(e.allOf))throw new In("allOf must be an array");var i=new Sn(t,e,r,n),o=this;return e.allOf.forEach(function(e,a){var s=o.validateSchema(t,e,r,n);if(!s.valid){var u=e.id&&"<"+e.id+">"||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+a+"]";i.addError({name:"allOf",argument:{id:u,length:s.errors.length,valid:s},message:"does not match allOf schema "+u+" with "+s.errors.length+" error[s]:"}),i.importErrors(s)}}),i},Cn.oneOf=function(t,e,r,n){if(void 0===t)return null;if(!Array.isArray(e.oneOf))throw new In("oneOf must be an array");var i=new Sn(t,e,r,n),o=new Sn(t,e,r,n),a=e.oneOf.filter(Un.bind(this,t,r,n,function(t){o.importErrors(t)})).length,s=e.oneOf.map(function(t,e){return t.id&&"<"+t.id+">"||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+e+"]"});return 1!==a&&(r.nestedErrors&&i.importErrors(o),i.addError({name:"oneOf",argument:s,message:"is not exactly one from "+s.join(",")})),i},Cn.properties=function(t,e,r,n){if(this.types.object(t)){var i=new Sn(t,e,r,n),o=e.properties||{};for(var a in o){"function"==typeof r.preValidateProperty&&r.preValidateProperty(t,a,o[a],r,n);var s=Object.hasOwnProperty.call(t,a)?t[a]:void 0,u=this.validateSchema(s,o[a],r,n.makeChild(o[a],a));u.instance!==i.instance[a]&&(i.instance[a]=u.instance),i.importErrors(u)}return i}},Cn.patternProperties=function(t,e,r,n){if(this.types.object(t)){var i=new Sn(t,e,r,n),o=e.patternProperties||{};for(var a in t){var s=!0;for(var u in o){if(RegExp(u).test(a)){s=!1,"function"==typeof r.preValidateProperty&&r.preValidateProperty(t,a,o[u],r,n);var c=this.validateSchema(t[a],o[u],r,n.makeChild(o[u],a));c.instance!==i.instance[a]&&(i.instance[a]=c.instance),i.importErrors(c)}}s&&Fn.call(this,t,e,r,n,a,i)}return i}},Cn.additionalProperties=function(t,e,r,n){if(this.types.object(t)){if(e.patternProperties)return null;var i=new Sn(t,e,r,n);for(var o in t)Fn.call(this,t,e,r,n,o,i);return i}},Cn.minProperties=function(t,e,r,n){if(this.types.object(t)){var i=new Sn(t,e,r,n);return Object.keys(t).length<e.minProperties&&i.addError({name:"minProperties",argument:e.minProperties,message:"does not meet minimum property length of "+e.minProperties}),i}},Cn.maxProperties=function(t,e,r,n){if(this.types.object(t)){var i=new Sn(t,e,r,n);return e.maxProperties<Object.keys(t).length&&i.addError({name:"maxProperties",argument:e.maxProperties,message:"does not meet maximum property length of "+e.maxProperties}),i}},Cn.items=function(t,e,r,n){var i=this;if(this.types.array(t)&&e.items){var o=new Sn(t,e,r,n);return t.every(function(t,a){var s=Array.isArray(e.items)?e.items[a]||e.additionalItems:e.items;if(void 0===s)return!0;if(!1===s)return o.addError({name:"items",message:"additionalItems not permitted"}),!1;var u=i.validateSchema(t,s,r,n.makeChild(s,a));return u.instance!==o.instance[a]&&(o.instance[a]=u.instance),o.importErrors(u),!0}),o}},Cn.minimum=function(t,e,r,n){if(this.types.number(t)){var i=new Sn(t,e,r,n);return(e.exclusiveMinimum&&!0===e.exclusiveMinimum?t>e.minimum:t>=e.minimum)||i.addError({name:"minimum",argument:e.minimum,message:"must have a minimum value of "+e.minimum}),i}},Cn.maximum=function(t,e,r,n){if(this.types.number(t)){var i=new Sn(t,e,r,n);return(e.exclusiveMaximum&&!0===e.exclusiveMaximum?e.maximum>t:e.maximum>=t)||i.addError({name:"maximum",argument:e.maximum,message:"must have a maximum value of "+e.maximum}),i}};var Dn=function(t,e,r,n,i,o){if(this.types.number(t)){var a=e[i];if(0==a)throw new In(i+" cannot be zero");var s=new Sn(t,e,r,n),u=jn.getDecimalPlaces(t),c=jn.getDecimalPlaces(a),p=Math.pow(10,Math.max(u,c));return Math.round(t*p)%Math.round(a*p)!=0&&s.addError({name:i,argument:a,message:o+JSON.stringify(a)}),s}};function zn(t,e,r){var n,i=r.length;for(n=e+1;i>n;n++)if(jn.deepCompareStrict(t,r[n]))return!1;return!0}Cn.multipleOf=function(t,e,r,n){return Dn.call(this,t,e,r,n,"multipleOf","is not a multiple of (divisible by) ")},Cn.divisibleBy=function(t,e,r,n){return Dn.call(this,t,e,r,n,"divisibleBy","is not divisible by (multiple of) ")},Cn.required=function(t,e,r,n){var i=new Sn(t,e,r,n);return void 0===t&&!0===e.required?i.addError({name:"required",message:"is required"}):this.types.object(t)&&Array.isArray(e.required)&&e.required.forEach(function(e){void 0===t[e]&&i.addError({name:"required",argument:e,message:"requires property "+JSON.stringify(e)})}),i},Cn.pattern=function(t,e,r,n){if(this.types.string(t)){var i=new Sn(t,e,r,n);return t.match(e.pattern)||i.addError({name:"pattern",argument:e.pattern,message:"does not match pattern "+JSON.stringify(e.pattern)}),i}},Cn.format=function(t,e,r,n){if(void 0!==t){var i=new Sn(t,e,r,n);return i.disableFormat||jn.isFormat(t,e.format,this)||i.addError({name:"format",argument:e.format,message:"does not conform to the "+JSON.stringify(e.format)+" format"}),i}},Cn.minLength=function(t,e,r,n){if(this.types.string(t)){var i=new Sn(t,e,r,n),o=t.match(/[\uDC00-\uDFFF]/g);return t.length-(o?o.length:0)<e.minLength&&i.addError({name:"minLength",argument:e.minLength,message:"does not meet minimum length of "+e.minLength}),i}},Cn.maxLength=function(t,e,r,n){if(this.types.string(t)){var i=new Sn(t,e,r,n),o=t.match(/[\uDC00-\uDFFF]/g);return e.maxLength<t.length-(o?o.length:0)&&i.addError({name:"maxLength",argument:e.maxLength,message:"does not meet maximum length of "+e.maxLength}),i}},Cn.minItems=function(t,e,r,n){if(this.types.array(t)){var i=new Sn(t,e,r,n);return t.length<e.minItems&&i.addError({name:"minItems",argument:e.minItems,message:"does not meet minimum length of "+e.minItems}),i}},Cn.maxItems=function(t,e,r,n){if(this.types.array(t)){var i=new Sn(t,e,r,n);return e.maxItems<t.length&&i.addError({name:"maxItems",argument:e.maxItems,message:"does not meet maximum length of "+e.maxItems}),i}},Cn.uniqueItems=function(t,e,r,n){if(this.types.array(t)){var i=new Sn(t,e,r,n);return t.every(function(t,e,r){for(var n=e+1;r.length>n;n++)if(jn.deepCompareStrict(t,r[n]))return!1;return!0})||i.addError({name:"uniqueItems",message:"contains duplicate item"}),i}},Cn.uniqueItems=function(t,e,r,n){if(this.types.array(t)){var i=new Sn(t,e,r,n);return t.every(zn)||i.addError({name:"uniqueItems",message:"contains duplicate item"}),i}},Cn.dependencies=function(t,e,r,n){if(this.types.object(t)){var i=new Sn(t,e,r,n);for(var o in e.dependencies)if(void 0!==t[o]){var a=e.dependencies[o],s=n.makeChild(a,o);if("string"==typeof a&&(a=[a]),Array.isArray(a))a.forEach(function(e){void 0===t[e]&&i.addError({name:"dependencies",argument:s.propertyPath,message:"property "+e+" not found, required by "+s.propertyPath})});else{var u=this.validateSchema(t,a,r,s);i.instance!==u.instance&&(i.instance=u.instance),u&&u.errors.length&&(i.addError({name:"dependencies",argument:s.propertyPath,message:"does not meet dependency required by "+s.propertyPath}),i.importErrors(u))}}return i}},Cn.enum=function(t,e,r,n){if(void 0===t)return null;if(!Array.isArray(e.enum))throw new In("enum expects an array",e);var i=new Sn(t,e,r,n);return e.enum.some(jn.deepCompareStrict.bind(null,t))||i.addError({name:"enum",argument:e.enum,message:"is not one of enum values: "+e.enum.map(String).join(",")}),i},Cn.const=function(t,e,r,n){if(void 0===t)return null;var i=new Sn(t,e,r,n);return jn.deepCompareStrict(e.const,t)||i.addError({name:"const",argument:e.const,message:"does not exactly match expected constant: "+e.const}),i},Cn.not=Cn.disallow=function(t,e,r,n){var i=this;if(void 0===t)return null;var o=new Sn(t,e,r,n),a=e.not||e.disallow;return a?(Array.isArray(a)||(a=[a]),a.forEach(function(a){if(i.testType(t,e,r,n,a)){var s=a&&a.id&&"<"+a.id+">"||a;o.addError({name:"not",argument:s,message:"is of prohibited type "+s})}}),o):null};var qn=Rn;function Bn(t,e){this.id=t,this.ref=e}var $n={SchemaScanResult:Bn,scan:function(t,e){function n(t,e){if(e&&"object"==r(e))if(e.$ref){var u=pn.resolve(t,e.$ref);s[u]=s[u]?s[u]+1:0}else{var c=e.id?pn.resolve(t,e.id):t;if(c){if(0>c.indexOf("#")&&(c+="#"),a[c]){if(!jn.deepCompareStrict(a[c],e))throw Error("Schema <"+e+"> already exists with different definition");return a[c]}a[c]=e,"#"==c[c.length-1]&&(a[c.substring(0,c.length-1)]=e)}i(c+"/items",e.items instanceof Array?e.items:[e.items]),i(c+"/extends",e.extends instanceof Array?e.extends:[e.extends]),n(c+"/additionalItems",e.additionalItems),o(c+"/properties",e.properties),n(c+"/additionalProperties",e.additionalProperties),o(c+"/definitions",e.definitions),o(c+"/patternProperties",e.patternProperties),o(c+"/dependencies",e.dependencies),i(c+"/disallow",e.disallow),i(c+"/allOf",e.allOf),i(c+"/anyOf",e.anyOf),i(c+"/oneOf",e.oneOf),n(c+"/not",e.not)}}function i(t,e){if(e instanceof Array)for(var r=0;e.length>r;r++)n(t+"/"+r,e[r])}function o(t,e){if(e&&"object"==r(e))for(var i in e)n(t+"/"+i,e[i])}var a={},s={};return n(t,e),new Bn(a,s)}},Nn=$n.scan,Mn=jn.ValidatorResult,Ln=jn.SchemaError,Vn=jn.SchemaContext,Yn=function t(){this.customFormats=Object.create(t.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(Zn),this.attributes=Object.create(qn.validators)};function Hn(t){var e="string"==typeof t?t:t.$ref;return"string"==typeof e&&e}Yn.prototype.customFormats={},Yn.prototype.schemas=null,Yn.prototype.types=null,Yn.prototype.attributes=null,Yn.prototype.unresolvedRefs=null,Yn.prototype.addSchema=function(t,e){var r=this;if(!t)return null;var n=Nn(e||"/",t),i=e||t.id;for(var o in n.id)this.schemas[o]=n.id[o];for(var o in n.ref)this.unresolvedRefs.push(o);return this.unresolvedRefs=this.unresolvedRefs.filter(function(t){return void 0===r.schemas[t]}),this.schemas[i]},Yn.prototype.addSubSchemaArray=function(t,e){if(e instanceof Array)for(var r=0;e.length>r;r++)this.addSubSchema(t,e[r])},Yn.prototype.addSubSchemaObject=function(t,e){if(e&&"object"==r(e))for(var n in e)this.addSubSchema(t,e[n])},Yn.prototype.setSchemas=function(t){this.schemas=t},Yn.prototype.getSchema=function(t){return this.schemas[t]},Yn.prototype.validate=function(t,e,r,n){r||(r={});var i=r.propertyName||"instance",o=pn.resolve(r.base||"/",e.id||"");if(!n){(n=new Vn(e,r,i,o,Object.create(this.schemas))).schemas[o]||(n.schemas[o]=e);var a=Nn(o,e);for(var s in a.id){n.schemas[s]=a.id[s]}}if(e){var u=this.validateSchema(t,e,r,n);if(!u)throw Error("Result undefined");return u}throw new Ln("no schema specified",e)},Yn.prototype.validateSchema=function(t,e,r,n){var i,o=new Mn(t,e,r,n);if("boolean"==typeof e)!0===e?e={}:!1===e&&(e={type:[]});else if(!e)throw Error("schema is undefined");if(e.extends)if(e.extends instanceof Array){var a={schema:e,ctx:n};e.extends.forEach(this.schemaTraverser.bind(this,a)),e=a.schema,a.schema=null,a.ctx=null,a=null}else e=jn.deepMerge(e,this.superResolve(e.extends,n));if(i=Hn(e)){var s=this.resolve(e,i,n),u=new Vn(s.subschema,r,n.propertyPath,s.switchSchema,n.schemas);return this.validateSchema(t,s.subschema,r,u)}var c=r&&r.skipAttributes||[];for(var p in e)if(!qn.ignoreProperties[p]&&0>c.indexOf(p)){var f=null,l=this.attributes[p];if(l)f=l.call(this,t,e,r,n);else if(!1===r.allowUnknownAttributes)throw new Ln("Unsupported attribute: "+p,e);f&&o.importErrors(f)}if("function"==typeof r.rewrite){var h=r.rewrite.call(this,t,e,r,n);o.instance=h}return o},Yn.prototype.schemaTraverser=function(t,e){t.schema=jn.deepMerge(t.schema,this.superResolve(e,t.ctx))},Yn.prototype.superResolve=function(t,e){var r;return(r=Hn(t))?this.resolve(t,r,e).subschema:t},Yn.prototype.resolve=function(t,e,r){if(e=r.resolve(e),r.schemas[e])return{subschema:r.schemas[e],switchSchema:e};var n=pn.parse(e),i=n&&n.hash,o=i&&i.length&&e.substr(0,e.length-i.length);if(!o||!r.schemas[o])throw new Ln("no such schema <"+e+">",t);var a=jn.objectGetPath(r.schemas[o],i.substr(1));if(void 0===a)throw new Ln("no such schema "+i+" located in <"+o+">",t);return{subschema:a,switchSchema:e}},Yn.prototype.testType=function(t,e,n,i,o){if("function"==typeof this.types[o])return this.types[o].call(this,t);if(o&&"object"==r(o)){var a=this.validateSchema(t,o,n,i);return void 0===a||!(a&&a.errors.length)}return!0};var Zn=Yn.prototype.types={};Zn.string=function(t){return"string"==typeof t},Zn.number=function(t){return"number"==typeof t&&isFinite(t)},Zn.integer=function(t){return"number"==typeof t&&t%1==0},Zn.boolean=function(t){return"boolean"==typeof t},Zn.array=function(t){return Array.isArray(t)},Zn.null=function(t){return null===t},Zn.date=function(t){return t instanceof Date},Zn.any=function(t){return!0},Zn.object=function(t){return t&&"object"===r(t)&&!(t instanceof Array)&&!(t instanceof Date)};var Jn,Xn,Gn,Kn,Qn,Wn,ti,ei,ri,ni,ii,oi,ai,si,ui,ci,pi=Yn,fi=ue(function(t){var e=t.exports.Validator=pi;t.exports.ValidatorResult=jn.ValidatorResult,t.exports.ValidationError=jn.ValidationError,t.exports.SchemaError=jn.SchemaError,t.exports.SchemaScanResult=$n.SchemaScanResult,t.exports.scan=$n.scan,t.exports.validate=function(t,r,n){return(new e).validate(t,r,n)}}),li=fi.Validator,hi=function(t){var e=new li;return function(r){return e.validate(r,t)}},mi=function(t){function e(r,n){var i=t.call(this,r)||this;return Object.setPrototypeOf(i,e.prototype),i.details=n,i}return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e}(Error);(Jn=t.AlignOptions||(t.AlignOptions={})).left="left",Jn.right="right",Jn.center="center",Jn.bottom="bottom",Jn.top="top",(Xn=t.AlignFacesOptions||(t.AlignFacesOptions={})).left="left",Xn.right="right",Xn.center="center",Xn.bottom="bottom",Xn.top="top",Xn.faces="faces",(Gn=t.FitOptions||(t.FitOptions={})).clip="clip",Gn.crop="crop",Gn.scale="scale",Gn.max="max",(Kn=t.BlurMode||(t.BlurMode={})).linear="linear",Kn.gaussian="gaussian",(Qn=t.ShapeType||(t.ShapeType={})).oval="oval",Qn.rect="rect",(Wn=t.NoiseType||(t.NoiseType={})).none="none",Wn.low="low",Wn.medium="medium",Wn.high="high",(ti=t.StyleType||(t.StyleType={})).artwork="artwork",ti.photo="photo",(ei=t.ColorspaceType||(t.ColorspaceType={})).RGB="RGB",ei.CMYK="CMYK",ei.Input="Input",(ri=t.CropfacesType||(t.CropfacesType={})).thumb="thumb",ri.crop="crop",ri.fill="fill",(ni=t.VideoTypes||(t.VideoTypes={})).h264="h264",ni.h264_hi="h264.hi",ni.webm="webm",ni["webm-hi"]="webm.hi",ni.ogg="ogg",ni["ogg-hi"]="ogg.hi",ni["hls-variant"]="hls.variant",ni.mp3="mp3",ni.oga="oga",ni.m4a="m4a",ni.aac="aac",ni.hls="hls.variant.audio",(ii=t.URLScreenshotAgent||(t.URLScreenshotAgent={})).desktop="desktop",ii.mobile="mobile",(oi=t.URLScreenshotMode||(t.URLScreenshotMode={})).all="all",oi.window="window",(ai=t.URLScreenshotOrientation||(t.URLScreenshotOrientation={})).portrait="portrait",ai.landscape="landscape",(si=t.Locations||(t.Locations={})).s3="s3",si.azure="azure",si.gcs="gcs",si.rackspace="rackspace",si.dropbox="dropbox",(ui=t.VideoAccess||(t.VideoAccess={})).private="private",ui.public="public",(ci=t.VideoAccessMode||(t.VideoAccessMode={})).preserve="preserve",ci.constrain="constrain",ci.letterbox="letterbox",ci.pad="pad",ci.crop="crop";var di,yi,gi,vi,bi,wi,xi,ki,_i,Ei,Ai,Pi,Oi,Ti,ji,Si,Ii=/^[\w\-]{20}$/,Ri=function(){function t(t,e){this.validator=hi(ze),this.transforms=[],this.b64=!1,this.source=t;var r=this.isSourceExternal();if(r&&!e)throw new mi("External sources requires apikey to handle transforms");if(!r&&"string"==typeof this.source&&!Ii.test(this.source))throw new mi("Invalid filestack source provided");this.apikey=e}return t.prototype.setBase64=function(t){return this.b64=t,this},t.prototype.setCname=function(t){return this.cname=t,this},t.prototype.setCustomDomain=function(t){return this.customDomain=t,this},t.prototype.getValidationSchema=function(){return ze},t.prototype.getTransformations=function(){return this.transforms},t.prototype.toString=function(){var t=[];t.push(this.getCdnHost()),this.apikey&&t.push(this.apikey);var e=this.generateTransformString(),r=this.source;return this.b64?(this.transforms.length>0&&(e="b64/"+btoa(JSON.stringify(this.transforms))),Array.isArray(r)&&(r=this.arrayToString(r)),r="b64://"+btoa(r)):r=Array.isArray(r)?this.arrayToString(r):this.escapeValue(r),e.length&&t.push(e),t.push(r),t.join("/")},t.prototype.addTask=function(t,e){if(this.validateTask(t,e),"cache"!==t&&"boolean"==typeof e){if(!e)return this;e=void 0}else"object"!==r(e)||Object.keys(e).length||(e=void 0);return this.transforms.push({name:t,params:e}),this},t.prototype.reset=function(){return this.transforms=[],this},t.prototype.flip=function(){return this.addTask("flip",!0)},t.prototype.flop=function(){return this.addTask("flop",!0)},t.prototype.enhance=function(){return this.addTask("enhance",!0)},t.prototype.redeye=function(){return this.addTask("redeye",!0)},t.prototype.monochrome=function(){return this.addTask("monochrome",!0)},t.prototype.negative=function(){return this.addTask("negative",!0)},t.prototype.tags=function(){return this.addTask("tags",!0)},t.prototype.sfw=function(){return this.addTask("sfw",!0)},t.prototype.store=function(t){return this.addTask("store",t)},t.prototype.cache=function(t){return this.addTask("cache",t)},t.prototype.resize=function(t){return this.addTask("resize",t)},t.prototype.crop=function(t){return this.addTask("crop",t)},t.prototype.rotate=function(t){return this.addTask("rotate",t)},t.prototype.detectFaces=function(t){return this.addTask("detect_faces",t)},t.prototype.cropFaces=function(t){return this.addTask("crop_faces",t)},t.prototype.pixelateFaces=function(t){return this.addTask("pixelate_faces",t)},t.prototype.blurFaces=function(t){return this.addTask("blur_faces",t)},t.prototype.roundedCorners=function(t){return this.addTask("rounded_corners",t)},t.prototype.polaroid=function(t){return this.addTask("polaroid",t)},t.prototype.vignette=function(t){return this.addTask("vignette",t)},t.prototype.tornEdges=function(t){return this.addTask("torn_edges",t)},t.prototype.shadow=function(t){return this.addTask("shadow",t)},t.prototype.circle=function(t){return this.addTask("circle",t)},t.prototype.border=function(t){return this.addTask("border",t)},t.prototype.sharpen=function(t){return this.addTask("sharpen",t)},t.prototype.blur=function(t){return this.addTask("blur",t)},t.prototype.blackwhite=function(t){return this.addTask("blackwhite",t)},t.prototype.sepia=function(t){return this.addTask("sepia",t)},t.prototype.pixelate=function(t){return this.addTask("pixelate",t)},t.prototype.oilPaint=function(t){return this.addTask("oil_paint",t)},t.prototype.modulate=function(t){return this.addTask("modulate",t)},t.prototype.partialPixelate=function(t){return this.addTask("partial_pixelate",t)},t.prototype.partialBlur=function(t){return this.addTask("partial_blur",t)},t.prototype.collage=function(t){return this.addTask("collage",t)},t.prototype.upscale=function(t){return this.addTask("upscale",t)},t.prototype.ascii=function(t){return this.addTask("ascii",t)},t.prototype.quality=function(t){return this.addTask("quality",t)},t.prototype.security=function(t){return this.addTask("security",t)},t.prototype.output=function(t){return this.addTask("output",t)},t.prototype.videoConvert=function(t){return this.addTask("video_convert",t)},t.prototype.URLScreenshot=function(t){return this.addTask("urlscreenshot",t)},t.prototype.PDFInfo=function(t){return this.addTask("pdfinfo",t)},t.prototype.PDFConvert=function(t){return this.addTask("pdfconvert",t)},t.prototype.fallback=function(t){return this.addTask("fallback",t)},t.prototype.isSourceExternal=function(){if(!this.source)throw new mi("Source not Set");var t=Array.isArray(this.source)?this.source:[this.source];for(var e in t)if(t.hasOwnProperty(e)&&(0===t[e].indexOf("src:")||0===t[e].indexOf("http")))return!0;return!1},t.prototype.validateTask=function(t,e){var r={};r[t]=e;var n=this.validator(r);if(n.errors.length)throw new mi('Task "'+t+'" validation error, Params: '+JSON.stringify(e),n.errors)},t.prototype.getCdnHost=function(){var t=e.urls;return this.customDomain&&(t.cdnUrl=this.customDomain),(t=Re(t,this.cname)).cdnUrl},t.prototype.generateTransformString=function(){var t=this,e=[];return this.transforms.forEach(function(r){e.push(t.optionToString(r.name,r.params))}),e.join("/")},t.prototype.optionToString=function(t,e){var n=this,i=[];return void 0===e?t:"object"!==r(e)||Object.keys(e).length?"boolean"==typeof e?e?t:"cache"===t?"cache=false":"":(Object.keys(e).forEach(function(t){i.push(Array.isArray(e[t])?t+":"+n.arrayToString(e[t]):t+":"+n.escapeValue(e[t]))}),t+"="+i.join(",")):t},t.prototype.escapeValue=function(t){return"string"!=typeof t?t:t.indexOf("/")>-1?'"'+t+'"':t},t.prototype.arrayToString=function(t){var e=this;return"["+t.map(function(t){return Array.isArray(t)?e.arrayToString(t):e.escapeValue(t)})+"]"},t}();(di=t.EAlignOptions||(t.EAlignOptions={})).left="left",di.right="right",di.center="center",di.bottom="bottom",di.top="top",(yi=t.EAlignFacesOptions||(t.EAlignFacesOptions={})).left="left",yi.right="right",yi.center="center",yi.bottom="bottom",yi.top="top",yi.faces="faces",(gi=t.EFitOptions||(t.EFitOptions={})).clip="clip",gi.crop="crop",gi.scale="scale",gi.max="max",(vi=t.EBlurMode||(t.EBlurMode={})).linear="linear",vi.gaussian="gaussian",(bi=t.EShapeType||(t.EShapeType={})).oval="oval",bi.rect="rect",(wi=t.ENoiseType||(t.ENoiseType={})).none="none",wi.low="low",wi.medium="medium",wi.high="high",(xi=t.EStyleType||(t.EStyleType={})).artwork="artwork",xi.photo="photo",(ki=t.EColorspaceType||(t.EColorspaceType={})).RGB="RGB",ki.CMYK="CMYK",ki.Input="Input",(_i=t.ECropfacesType||(t.ECropfacesType={})).thumb="thumb",_i.crop="crop",_i.fill="fill",(Ei=t.EVideoTypes||(t.EVideoTypes={})).h264="h264",Ei.h264_hi="h264.hi",Ei.webm="webm",Ei["webm-hi"]="webm.hi",Ei.ogg="ogg",Ei["ogg-hi"]="ogg.hi",Ei["hls-variant"]="hls.variant",Ei.mp3="mp3",Ei.oga="oga",Ei.m4a="m4a",Ei.aac="aac",Ei.hls="hls.variant.audio",(Ai=t.EUrlscreenshotAgent||(t.EUrlscreenshotAgent={})).desktop="desktop",Ai.mobile="mobile",(Pi=t.EUrlscreenshotMode||(t.EUrlscreenshotMode={})).all="all",Pi.window="window",(Oi=t.EUrlscreenshotOrientation||(t.EUrlscreenshotOrientation={})).portrait="portrait",Oi.landscape="landscape",(Ti=t.EVideoLocations||(t.EVideoLocations={})).s3="s3",Ti.azure="azure",Ti.gcs="gcs",Ti.rackspace="rackspace",Ti.dropbox="dropbox",(ji=t.EVideoAccess||(t.EVideoAccess={})).private="private",ji.public="public",(Si=t.EVideoAccessMode||(t.EVideoAccessMode={})).preserve="preserve",Si.constrain="constrain",Si.letterbox="letterbox",Si.pad="pad",Si.crop="crop";var Ci=function(t,e,n,i){void 0===n&&(n={}),void 0===i&&(i=!1),n=function t(e){for(var n={},i=Object.keys(e),o=0;i.length>o;o++){var a=i[o].split(/(?=[A-Z])/).join("_").toLowerCase();n[a]="object"!==r(e[i[o]])||Array.isArray(e[i[o]])?e[i[o]]:t(e[i[o]])}return n}(n),t.policy&&t.signature&&(n.security={policy:t.policy,signature:t.signature});var o=new Ri(e,t.apikey);return o.setCname(t.cname),o.setBase64(i),t.urls.cdnUrl.indexOf("localhost")>-1&&o.setCustomDomain(t.urls.cdnUrl),Object.keys(n).forEach(function(t){("boolean"!=typeof n[t]||n[t]||"cache"===t)&&o.addTask(t,n[t])}),""+o};var Ui,Fi,Di,zi={atob:function(t){if((t=(t="".concat(t)).replace(/[ \t\n\f\r]/g,"")).length%4==0&&(t=t.replace(/==?$/,"")),t.length%4==1||/[^+/0-9A-Za-z]/.test(t))return null;for(var e="",r=0,n=0,i=0;t.length>i;i++)r<<=6,r|=(o=t[i],/[A-Z]/.test(o)?o.charCodeAt(0)-65:/[a-z]/.test(o)?o.charCodeAt(0)-97+26:/[0-9]/.test(o)?o.charCodeAt(0)-48+52:"+"===o?62:"/"===o?63:void 0),24===(n+=6)&&(e+=String.fromCharCode((16711680&r)>>16),e+=String.fromCharCode((65280&r)>>8),e+=String.fromCharCode(255&r),r=n=0);var o;return 12===n?e+=String.fromCharCode(r>>=4):18===n&&(e+=String.fromCharCode((65280&(r>>=2))>>8),e+=String.fromCharCode(255&r)),e},btoa:function(t){var e;for(t="".concat(t),e=0;t.length>e;e++)if(t.charCodeAt(e)>255)return null;var r="";for(e=0;t.length>e;e+=3){var n=[void 0,void 0,void 0,void 0];n[0]=t.charCodeAt(e)>>2,n[1]=(3&t.charCodeAt(e))<<4,t.length>e+1&&(n[1]|=t.charCodeAt(e+1)>>4,n[2]=(15&t.charCodeAt(e+1))<<2),t.length>e+2&&(n[2]|=t.charCodeAt(e+2)>>6,n[3]=63&t.charCodeAt(e+2));for(var i=0;n.length>i;i++)r+=void 0===n[i]?"=":26>(o=n[i])?String.fromCharCode(o+65):52>o?String.fromCharCode(o-26+97):62>o?String.fromCharCode(o-52+48):62===o?"+":63===o?"/":void 0}var o;return r}},qi=zi.atob,Bi=zi.btoa,$i=ue(function(t,e){t.exports=function(t){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function r(t,e){var r=t[0],n=t[1],i=t[2],o=t[3];n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+e[0]-680876936|0)<<7|r>>>25)+n|0)&n|~r&i)+e[1]-389564586|0)<<12|o>>>20)+r|0)&r|~o&n)+e[2]+606105819|0)<<17|i>>>15)+o|0)&o|~i&r)+e[3]-1044525330|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+e[4]-176418897|0)<<7|r>>>25)+n|0)&n|~r&i)+e[5]+1200080426|0)<<12|o>>>20)+r|0)&r|~o&n)+e[6]-1473231341|0)<<17|i>>>15)+o|0)&o|~i&r)+e[7]-45705983|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+e[8]+1770035416|0)<<7|r>>>25)+n|0)&n|~r&i)+e[9]-1958414417|0)<<12|o>>>20)+r|0)&r|~o&n)+e[10]-42063|0)<<17|i>>>15)+o|0)&o|~i&r)+e[11]-1990404162|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+e[12]+1804603682|0)<<7|r>>>25)+n|0)&n|~r&i)+e[13]-40341101|0)<<12|o>>>20)+r|0)&r|~o&n)+e[14]-1502002290|0)<<17|i>>>15)+o|0)&o|~i&r)+e[15]+1236535329|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+e[1]-165796510|0)<<5|r>>>27)+n|0)&i|n&~i)+e[6]-1069501632|0)<<9|o>>>23)+r|0)&n|r&~n)+e[11]+643717713|0)<<14|i>>>18)+o|0)&r|o&~r)+e[0]-373897302|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+e[5]-701558691|0)<<5|r>>>27)+n|0)&i|n&~i)+e[10]+38016083|0)<<9|o>>>23)+r|0)&n|r&~n)+e[15]-660478335|0)<<14|i>>>18)+o|0)&r|o&~r)+e[4]-405537848|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+e[9]+568446438|0)<<5|r>>>27)+n|0)&i|n&~i)+e[14]-1019803690|0)<<9|o>>>23)+r|0)&n|r&~n)+e[3]-187363961|0)<<14|i>>>18)+o|0)&r|o&~r)+e[8]+1163531501|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+e[13]-1444681467|0)<<5|r>>>27)+n|0)&i|n&~i)+e[2]-51403784|0)<<9|o>>>23)+r|0)&n|r&~n)+e[7]+1735328473|0)<<14|i>>>18)+o|0)&r|o&~r)+e[12]-1926607734|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+e[5]-378558|0)<<4|r>>>28)+n|0)^n^i)+e[8]-2022574463|0)<<11|o>>>21)+r|0)^r^n)+e[11]+1839030562|0)<<16|i>>>16)+o|0)^o^r)+e[14]-35309556|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+e[1]-1530992060|0)<<4|r>>>28)+n|0)^n^i)+e[4]+1272893353|0)<<11|o>>>21)+r|0)^r^n)+e[7]-155497632|0)<<16|i>>>16)+o|0)^o^r)+e[10]-1094730640|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+e[13]+681279174|0)<<4|r>>>28)+n|0)^n^i)+e[0]-358537222|0)<<11|o>>>21)+r|0)^r^n)+e[3]-722521979|0)<<16|i>>>16)+o|0)^o^r)+e[6]+76029189|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+e[9]-640364487|0)<<4|r>>>28)+n|0)^n^i)+e[12]-421815835|0)<<11|o>>>21)+r|0)^r^n)+e[15]+530742520|0)<<16|i>>>16)+o|0)^o^r)+e[2]-995338651|0)<<23|n>>>9)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+e[0]-198630844|0)<<6|r>>>26)+n|0)|~i))+e[7]+1126891415|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+e[14]-1416354905|0)<<15|i>>>17)+o|0)|~r))+e[5]-57434055|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+e[12]+1700485571|0)<<6|r>>>26)+n|0)|~i))+e[3]-1894986606|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+e[10]-1051523|0)<<15|i>>>17)+o|0)|~r))+e[1]-2054922799|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+e[8]+1873313359|0)<<6|r>>>26)+n|0)|~i))+e[15]-30611744|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+e[6]-1560198380|0)<<15|i>>>17)+o|0)|~r))+e[13]+1309151649|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+e[4]-145523070|0)<<6|r>>>26)+n|0)|~i))+e[11]-1120210379|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+e[2]+718787259|0)<<15|i>>>17)+o|0)|~r))+e[9]-343485551|0)<<21|n>>>11)+i|0,t[0]=r+t[0]|0,t[1]=n+t[1]|0,t[2]=i+t[2]|0,t[3]=o+t[3]|0}function n(t){var e,r=[];for(e=0;64>e;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}function i(t){var e,r=[];for(e=0;64>e;e+=4)r[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return r}function o(t){var e,i,o,a,s,u,c=t.length,p=[1732584193,-271733879,-1732584194,271733878];for(e=64;c>=e;e+=64)r(p,n(t.substring(e-64,e)));for(t=t.substring(e-64),i=t.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;i>e;e+=1)o[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(o[e>>2]|=128<<(e%4<<3),e>55)for(r(p,o),e=0;16>e;e+=1)o[e]=0;return a=(a=8*c).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),u=parseInt(a[1],16)||0,o[14]=s,o[15]=u,r(p,o),p}function a(t){var r,n="";for(r=0;4>r;r+=1)n+=e[t>>8*r+4&15]+e[t>>8*r&15];return n}function s(t){var e;for(e=0;t.length>e;e+=1)t[e]=a(t[e]);return t.join("")}function u(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function c(t){var e,r=[],n=t.length;for(e=0;n-1>e;e+=2)r.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,r)}function p(){this.reset()}return s(o("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(t,e){return 0>(t=0|t||0)?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(r,n){var i,o,a,s,u=this.byteLength,c=e(r,u),p=u;return n!==t&&(p=e(n,u)),c>p?new ArrayBuffer(0):(i=p-c,o=new ArrayBuffer(i),a=new Uint8Array(o),s=new Uint8Array(this,c,i),a.set(s),o)}}(),p.prototype.append=function(t){return this.appendBinary(u(t)),this},p.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var e,i=this._buff.length;for(e=64;i>=e;e+=64)r(this._hash,n(this._buff.substring(e-64,e)));return this._buff=this._buff.substring(e-64),this},p.prototype.end=function(t){var e,r,n=this._buff,i=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;i>e;e+=1)o[e>>2]|=n.charCodeAt(e)<<(e%4<<3);return this._finish(o,i),r=s(this._hash),t&&(r=c(r)),this.reset(),r},p.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},p.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},p.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},p.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},p.prototype._finish=function(t,e){var n,i,o,a=e;if(t[a>>2]|=128<<(a%4<<3),a>55)for(r(this._hash,t),a=0;16>a;a+=1)t[a]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),o=parseInt(n[1],16)||0,t[14]=i,t[15]=o,r(this._hash,t)},p.hash=function(t,e){return p.hashBinary(u(t),e)},p.hashBinary=function(t,e){var r=s(o(t));return e?c(r):r},(p.ArrayBuffer=function(){this.reset()}).prototype.append=function(t){var e,n,o,a,s,u=(n=this._buff.buffer,o=t,a=!0,(s=new Uint8Array(n.byteLength+o.byteLength)).set(new Uint8Array(n)),s.set(new Uint8Array(o),n.byteLength),a?s:s.buffer),c=u.length;for(this._length+=t.byteLength,e=64;c>=e;e+=64)r(this._hash,i(u.subarray(e-64,e)));return this._buff=c>e-64?new Uint8Array(u.buffer.slice(e-64)):new Uint8Array(0),this},p.ArrayBuffer.prototype.end=function(t){var e,r,n=this._buff,i=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;i>e;e+=1)o[e>>2]|=n[e]<<(e%4<<3);return this._finish(o,i),r=s(this._hash),t&&(r=c(r)),this.reset(),r},p.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},p.ArrayBuffer.prototype.getState=function(){var t=p.prototype.getState.call(this);return t.buff=String.fromCharCode.apply(null,new Uint8Array(t.buff)),t},p.ArrayBuffer.prototype.setState=function(t){return t.buff=function(t,e){var r,n=t.length,i=new ArrayBuffer(n),o=new Uint8Array(i);for(r=0;n>r;r+=1)o[r]=t.charCodeAt(r);return e?o:i}(t.buff,!0),p.prototype.setState.call(this,t)},p.ArrayBuffer.prototype.destroy=p.prototype.destroy,p.ArrayBuffer.prototype._finish=p.prototype._finish,p.ArrayBuffer.hash=function(t,e){var n=s(function(t){var e,n,o,a,s,u,c=t.length,p=[1732584193,-271733879,-1732584194,271733878];for(e=64;c>=e;e+=64)r(p,i(t.subarray(e-64,e)));for(t=c>e-64?t.subarray(e-64):new Uint8Array(0),n=t.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;n>e;e+=1)o[e>>2]|=t[e]<<(e%4<<3);if(o[e>>2]|=128<<(e%4<<3),e>55)for(r(p,o),e=0;16>e;e+=1)o[e]=0;return a=(a=8*c).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),u=parseInt(a[1],16)||0,o[14]=s,o[15]=u,r(p,o),p}(new Uint8Array(t)));return e?c(n):n},p}()}).ArrayBuffer,Ni=function(t){return Bi($i.hash(t,!0))},Mi=function(t,e){var r=function(t,e){var r=t.config,n=e*r.partSize;return{start:n,end:Math.min(n+r.partSize,t.file.size)}}(t,e);return t.file.slice(r.start,r.end)},Li=function(t,e){return(r=Mi(e,t.number),new Promise(function(t,e){var n;File&&FileReader&&Blob?((n=new FileReader).onloadend=t,n.onerror=e,n.readAsArrayBuffer(r)):e(Error("The File APIs are not fully supported by your browser"))})).then(function(e){var r=e.target.result;return i({},t,{buffer:r,size:r.byteLength,md5:Ni(r)})});var r},Vi=function(t){var e,r=t;return"string"==typeof t&&(r=function(t,e){var r;void 0===e&&(e=512);var n="";0>t.split(",")[0].indexOf("base64")||(r=t.split(",")[1]),void 0!==r&&(n=t.split(",")[0].split(":")[1].split(";")[0],t=decodeURI(r));for(var i=qi(t),o=[],a=0;i.length>a;a+=e){for(var s=i.slice(a,a+e),u=Array(s.length),c=0;s.length>c;c+=1)u[c]=s.charCodeAt(c);var p=new Uint8Array(u);o.push(p)}return new Blob(o,{type:n})}(r)),r&&(""+(e=r)=="[object File]"||""+e=="[object Blob]")?Promise.resolve(r):Promise.reject(new TypeError("File argument is not a valid Blob"))},Yi=function(t,e){return e.customName||t.name},Hi=function(t){return t&&"https://"+t},Zi=function(t,e){var n=e.store,i={};return Object.keys(t).forEach(function(e){"object"===r(t[e])&&(t[e]=JSON.stringify(t[e])),t[e]&&(i[e]=t[e])}),Object.keys(n).forEach(function(t){"object"===r(n[t])&&(n[t]=JSON.stringify(n[t])),n[t]&&(i[t]=n[t])}),i},Ji=function(t,e){var r=e.config,n=e.params,o=Hi(n.location_url),a=n.location_region,s=i({apikey:r.apikey,part:t.number+1,size:t.size,md5:t.md5},n);void 0!==t.offset&&(s.multipart=!0,s.offset=0===t.offset?"0":t.offset);var u=Zi(s,r),c=Pe("post",o+"/multipart/upload");return a&&c.set("Filestack-Upload-Region",a),c.timeout(r.timeout),c.field(u),new Promise(function(t,e){c.end(function(r,n){return r?e(r):t(n)})})},Xi=function(t,e,r,n){var i=n.timeout||t.byteLength/100,o=_e(e.url).set(e.headers).timeout(i).send(t);return r?o.on("progress",r):o},Gi="init",Ki="running",Qi="done",Wi="failed",to="paused",eo=function(t,e){return function(){for(var r=[],n=0;arguments.length>n;n++)r[n]=arguments[n];return t.state.status===Wi?Promise.resolve():new Promise(function(n){!function i(){t.state.status===to?setTimeout(function(){return i()},100):n(e.apply(void 0,r))}()})}},ro=function(t,e){return{buffer:null,chunks:[],chunkSize:e.config.intelligentChunkSize?e.config.intelligentChunkSize:(r=navigator.userAgent||navigator.vendor||window.opera,/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(r)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(r.substr(0,4))?1048576:8388608),intelligentOverride:!1,loaded:0,number:t,request:null,size:0};var r},no=function(t,e){return o(void 0,void 0,void 0,function(){var r,n,s,u;return a(this,function(c){switch(c.label){case 0:return!0===(r=e.config).intelligent||t.intelligentOverride?(n=eo(e,function(t){return function(t,e){return o(void 0,void 0,void 0,function(){var r,n;return a(this,function(i){switch(i.label){case 0:return[4,Ji(t,e)];case 1:return r=i.sent().body,e.config.onProgress&&(n=Fe(function(e){e.loaded>t.loaded&&(t.loaded=e.loaded)},e.config.progressInterval)),t.request=Xi(t.buffer,r,n,e.config),[4,t.request];case 2:return i.sent(),t.loaded=t.size,[2,t.request]}})})}(t,e)}),t.chunks=function(t,e){for(var r=0,n=[];t.size>r;){var i=t.buffer.slice(r,Math.min(r+e,t.size)),o={buffer:i,offset:r,size:i.byteLength,number:t.number,md5:Ni(i)};n.push(o),r+=e}return n}(t,t.chunkSize),[4,Promise.all(t.chunks.map(Ie(r.concurrency,n)))]):[3,2];case 1:return c.sent(),[2,function(t,e){var r=e.config,n=Hi(e.params.location_url),o=i({apikey:r.apikey,part:t.number+1,size:e.file.size},e.params),a=Zi(o,r);return Pe("post",n+"/multipart/commit").timeout(r.timeout).field(a)}(t,e)];case 2:return[4,Ji(t,e)];case 3:return s=c.sent().body,r.onProgress&&(u=Fe(function(e){e.loaded>t.loaded&&(t.loaded=e.loaded)},r.progressInterval)),t.request=Xi(t.buffer,s,u,r),[2,t.request]}})})},io=function t(e){e.buffer=void 0,e.request=void 0,e.chunks&&e.chunks.length&&e.chunks.forEach(t)},oo=function(t){var e=t.config,r=t.state,n=t.file,i=Object.keys(r.parts).map(function(t){return r.parts[t]}),o=i.map(function(t){return t.loaded}),a=i.map(function(t){return t.chunks}).reduce(function(t,e){return t.concat(e)},[]).map(function(t){return t.loaded}).filter(function(t){return t}),s=o;(!0===e.intelligent&&(s=a),"fallback"===e.intelligent)&&(s=i.filter(function(t){return!t.intelligentOverride}).map(function(t){return t.loaded}).concat(a));var u=s.reduce(function(t,e){return t+e},0),c=function(t,e){return Math.round(t/e.size*100)}(u,n),p={totalBytes:u,totalPercent:c},f=r.previousPayload||{};return f.totalPercent>c&&(p.totalBytes=f.totalBytes,p.totalPercent=f.totalPercent),r.previousPayload=p,p},ao=function(t,e){return o(void 0,void 0,void 0,function(){var r,n,s,u,c,p,f,l,h,m,d,y,g,v,b,w,x=this;return a(this,function(k){switch(k.label){case 0:return r=t.file,n=t.state,s=t.config,u=function(e){e&&(n.progressTick=setInterval(function(){var r=oo(t);100===r.totalPercent&&clearInterval(n.progressTick),e(r)},s.progressInterval))},c=function(t){t&&(t({totalBytes:r.size,totalPercent:100}),clearInterval(n.progressTick))},e.pause=function(){n.status===Ki&&(n.status=to,clearInterval(n.progressTick))},e.resume=function(){n.status===to&&(n.status=Ki,u(s.onProgress))},p=function(){Object.keys(n.parts).map(function(t){return n.parts[t]}).forEach(function(t){t.request&&t.request.abort(),t.chunks.forEach(function(t){t.request&&t.request.abort()}),io(t)})},f=function(){p(),clearInterval(n.progressTick),n.status=Wi,r.buffer&&(r.buffer=null)},l=new Promise(function(t,r){e.cancel=function(){n.status!==Ki&&n.status!==to||(f(),r(Error("Upload cancelled")))}}),h=function(t){return Promise.race([l,t])},m=function(t,e,i,o){var a=n.retries[t]||0,u=Math.min(s.retryMaxTime,1e3*Math.pow(s.retryFactor,a)),c=new Promise(function(c,p){if(a===s.retry||400===i.status&&"PUT"!==i.method||401===i.status||403===i.status||404===i.status||o&&32768>=o.chunkSize)return f(),p(i);var l=function(){return setTimeout(function(){return c(e())},u)};return o&&(s.intelligent||o.intelligentOverride)&&("PUT"===i.method&&(i.crossDomain||400===i.status)||"ECONNABORTED"===i.code&&i.timeout||"ECONNRESET"===i.code||"ETIMEDOUT"===i.code)?(o.chunkSize/=2,s.onRetry&&s.onRetry({location:t,parts:n.parts,filename:Yi(r,s),chunkSize:o.chunkSize,attempt:void 0}),"fallback"===s.intelligent&&(o.intelligentOverride=!0),l()):(n.retries[t]=a+=1,s.onRetry&&s.onRetry({location:t,parts:n.parts,filename:Yi(r,s),attempt:a}),l())});return h(c)},n.status=Ki,[4,h(function(t){var e=t.config,r=t.file,n={apikey:e.apikey,filename:Yi(r,e),mimetype:e.mimetype||r.type||"application/octet-stream",size:r.size};e.policy&&e.signature&&(n.policy=e.policy,n.signature=e.signature),e.intelligent&&(n.multipart=!0);var i=Zi(n,e);return Pe("post",e.host+"/multipart/start").timeout(e.timeout).field(i)}(t))];case 1:return d=k.sent().body,t.params=d,y=eo(t,function(e){return o(x,void 0,void 0,function(){var r,i,o,u,c;return a(this,function(a){switch(a.label){case 0:return[4,Li(e,t)];case 1:if(0===(r=a.sent()).size)return[2,Promise.reject(Error("Upload aborted due to empty chunk."))];i="upload part "+(r.number+1),n.parts[r.number]=r,a.label=2;case 2:return a.trys.push([2,4,,5]),[4,no(r,t)];case 3:return o=a.sent(),u=o.headers.etag,206===o.status?[2,m(i,function(){return y(r)},Error("Intelligent part failed to commit"),r)]:(r.loaded=r.size,io(r),s.intelligent||u?[2,u]:[2,Promise.reject(Error("Response from S3 is missing ETag header."))]);case 4:return c=a.sent(),[2,m(i,function(){return y(r)},c,r)];case 5:return[2]}})})}),g=function(t,e,r){void 0===r&&(r=1);for(var n=[];e>t;t+=r)n.push(t);return n}(0,Math.ceil(r.size/s.partSize)).map(function(e){return ro(e,t)}),v=Promise.all(g.map(Ie(s.concurrency,y))),u(s.onProgress),[4,h(v)];case 2:return b=k.sent(),w=eo(t,function(){return o(x,void 0,void 0,function(){var e,o;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,function(t,e){var r=e.config,n=e.file,o=e.params,a=Hi(o.location_url),s=o.location_region,u=i({apikey:r.apikey,size:n.size,filename:Yi(n,r),mimetype:r.mimetype||n.type||"application/octet-stream",parts:function(t){return t.map(function(t,e){return e+1+":"+t}).join(";")}(t)},o);r.intelligent&&(u.multipart=!0,delete u.parts),r.policy&&r.signature&&(u.policy=r.policy,u.signature=r.signature);var c=Zi(u,r),p=Pe("post",a+"/multipart/complete");return s&&p.set("Filestack-Upload-Region",s),p.timeout(r.timeout),p.field(c)}(b,t)];case 1:return 202===(e=a.sent()).status?[2,new Promise(function(t){setTimeout(function(){return t(w())},1e3)})]:(n.status=Qi,c(s.onProgress),r.buffer&&(r.buffer=null),e.body&&e.body.error&&e.body.error.text?[2,Promise.reject(Error("File upload error: "+e.body.error.text))]:[2,e.body]);case 2:return o=a.sent(),[2,m("complete",w,o)];case 3:return[2]}})})}),[2,h(w())]}})})},so=function(t,e,r){if(!e||"string"!=typeof e)throw Error("A valid Filestack handle or storage alias is required for preview");Ce("preview",[{name:"id",type:te},{name:"css",type:te}],r);var n=Ue(r),o=function(t,e,r,n){var o=i({},r),a=n&&n.policy||t.policy,s=n&&n.signature||t.signature,u=s&&a,c=[t.urls.cdnUrl],p=o.css&&encodeURIComponent('"'+o.css+'"'),f=p?"preview=css:"+p:"preview";return-1!==e.indexOf("src:")?c.push(t.apikey+"/"+f):c.push(f),u&&c.push("security=policy:"+a+",signature:"+s),c.push(e),c.join("/")}(t,e,n);if(n.id){var a=n.id,s=document.createElement("iframe"),u=document.getElementById(a);if(s.src=o,s.width="100%",s.height="100%",!u)throw Error('DOM Element with id "'+a+'" not found.');return u.appendChild(s)}return window.open(o,e)},uo=function(){function t(t,e){this.cache=!1,this.session=t,this.cloudApiUrl=t.urls.cloudApiUrl,e&&e.sessionCache&&(this.cache=e.sessionCache)}return Object.defineProperty(t.prototype,"token",{get:function(){if(this.cache){var t=localStorage.getItem("__fs_picker_token");if(t)return t}return this._token},set:function(t){this.cache&&localStorage.setItem("__fs_picker_token",t),this._token=t},enumerable:!0,configurable:!0}),t.prototype.prefetch=function(){var t={apikey:this.session.apikey};return Pe("get",this.cloudApiUrl+"/prefetch").query(t).then(function(t){return t.body})},t.prototype.list=function(t,e){var r=this;void 0===e&&(e={});var n={apikey:this.session.apikey,clouds:t,flow:"web",token:this.token};return this.session.policy&&this.session.signature&&(n.policy=this.session.policy,n.signature=this.session.signature),new Promise(function(t,i){var o=Pe("post",r.cloudApiUrl+"/folder/list").send(n).end(function(e,n){e?i(e):(n.body&&n.body.token&&(r.token=n.body.token),t(n.body))});e.cancel=function(){o.abort(),i(Error("Cancelled"))}})},t.prototype.store=function(t,e,r,n,i){var o,a=this;void 0===r&&(r={}),void 0===n&&(n={}),void 0===i&&(i={}),void 0===r.location&&(r.location="s3");var s={apikey:this.session.apikey,token:this.token,flow:"web",clouds:(o={},o[t]={path:e,store:Ue(r)},o)};return"customsource"===t&&n.customSourcePath&&(s.clouds.customsource.customSourcePath=n.customSourcePath),"customsource"===t&&n.customSourceContainer&&(s.clouds.customsource.customSourceContainer=n.customSourceContainer),this.session.policy&&this.session.signature&&(s.policy=this.session.policy,s.signature=this.session.signature),new Promise(function(e,r){var n=Pe("post",a.cloudApiUrl+"/store/").send(s).end(function(n,i){n?r(n):(i.body&&i.body.token&&(a.token=i.body.token),e(i.body&&i.body[t]?i.body[t]:i.body))});i.cancel=function(){n.abort(),r(Error("Cancelled"))}})},t.prototype.link=function(t,e,r,n){var i,o=this;void 0===r&&(r={}),void 0===n&&(n={});var a={apikey:this.session.apikey,token:this.token,flow:"web",clouds:(i={},i[t]={path:e},i)};return"customsource"===t&&r.customSourcePath&&(a.clouds.customsource.customSourcePath=r.customSourcePath),"customsource"===t&&r.customSourceContainer&&(a.clouds.customsource.customSourceContainer=r.customSourceContainer),this.session.policy&&this.session.signature&&(a.policy=this.session.policy,a.signature=this.session.signature),new Promise(function(e,r){var i=Pe("post",o.cloudApiUrl+"/link/").send(a).end(function(n,i){n?r(n):(i.body&&i.body.token&&(o.token=i.body.token),e(i.body[t]?i.body[t]:i.body))});n.cancel=function(){i.abort(),r(Error("Cancelled"))}})},t.prototype.logout=function(t){var e,r=this,n={apikey:this.session.apikey,flow:"web",token:this.token};return t?n.clouds=((e={})[t]={},e):this.cache&&localStorage.removeItem("__fs_picker_token"),new Promise(function(t,e){Pe("post",r.cloudApiUrl+"/auth/logout/").send(n).end(function(n,i){n?e(n):(i.body&&i.body.token&&(r.token=i.body.token),t(i.body))})})},t.prototype.metadata=function(t){var e=this,r={apikey:this.session.apikey,url:t};return this.session.policy&&this.session.signature&&(r.policy=this.session.policy,r.signature=this.session.signature),new Promise(function(t,n){Pe("post",e.cloudApiUrl+"/metadata").send(r).end(function(e,r){e?n(e):t(r.body)})})},t.prototype.tokInit=function(t){var e=this;if("video"!==t&&"audio"!==t)throw Error("Type must be one of video or audio.");return new Promise(function(r,n){return Pe("post",e.cloudApiUrl+"/recording/"+t+"/init").end(function(t,e){t?n(t):r(e)})})},t.prototype.tokStart=function(t,e,r){var n=this;if("video"!==t&&"audio"!==t)throw Error("Type must be one of video or audio.");var i={apikey:e,session_id:r};return new Promise(function(e,r){return Pe("post",n.cloudApiUrl+"/recording/"+t+"/start").send(i).end(function(t,n){t?r(t):e(n)})})},t.prototype.tokStop=function(t,e,r,n){var i=this;if("video"!==t&&"audio"!==t)throw Error("Type must be one of video or audio.");var o={apikey:e,session_id:r,archive_id:n};return new Promise(function(e,r){return Pe("post",i.cloudApiUrl+"/recording/"+t+"/stop").send(o).end(function(t,n){t?r(t):e(n)})})},t}(),co="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(t){return r(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":r(t)},po=(Ui=void 0,"object"===("undefined"==typeof window?"undefined":co(window))&&((Ui=window.filestackInternals)||(Ui={},window.filestackInternals=Ui),Ui.loader||(Ui.loader={modules:{}})),Ui),fo=po&&po.loader.modules,lo=function(t,e){var r=fo[t];if(r||(fo[t]={},r=fo[t]),r.instance)return Promise.resolve(r.instance);if(r.promise)return r.promise;var n=new Promise(function(n,i){!function o(){"complete"===document.readyState?function(){r.resolvePromise=n;var o=document.createElement("script");o.src=t,o.onerror=i,e&&(o.id=e),document.body.appendChild(o)}():setTimeout(o,50)}()});return r.promise=n,n},ho="__filestack-picker-module";!function(t){t.cw="CW",t.ccw="CCW"}(Fi||(Fi={})),function(t){t.inline="inline",t.overlay="overlay",t.dropPane="dropPane"}(Di||(Di={}));var mo=function(){function t(t,e){this._initialized=this.loadModule(t,e)}return t.prototype.open=function(){return o(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this._initialized];case 1:return[4,t.sent().open()];case 2:return t.sent(),[2]}})})},t.prototype.crop=function(t){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,this._initialized];case 1:return[4,e.sent().crop(t)];case 2:return e.sent(),[2]}})})},t.prototype.close=function(){return o(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this._initialized];case 1:return[4,t.sent().close()];case 2:return t.sent(),[2]}})})},t.prototype.cancel=function(){return o(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this._initialized];case 1:return[4,t.sent().cancel()];case 2:return t.sent(),[2]}})})},t.prototype.loadModule=function(t,e){return o(this,void 0,void 0,function(){return a(this,function(r){switch(r.label){case 0:return[4,lo(t.session.urls.pickerUrl,ho)];case 1:return[2,new(r.sent())(t,e)]}})})},t}(),yo=function(){function t(t,r){var n=this;if(!t||"string"!=typeof t||0===t.length)throw Error("An apikey is required to initialize the Filestack client");var i=e.urls;if(this.session={apikey:t,urls:i},r){var o=r.cname,a=r.security;if(a&&(!a.policy||!a.signature))throw Error("Both policy and signature are required for client security");if(a&&a.policy&&a.signature&&(this.session.policy=a.policy,this.session.signature=a.signature),o){this.session.urls=Re(this.session.urls,o);var s=/filestackapi.com|filestackcontent.com/i;this.session.cname=o,Object.keys(i).forEach(function(t){n.session.urls[t]=i[t].replace(s,o)})}}this.cloud=new uo(this.session,r)}return t.prototype.logout=function(t){return this.cloud.logout(t)},t.prototype.metadata=function(t,e,r){return function(t,e,r,n){if(!e||"string"!=typeof e)throw Error("A valid Filestack handle is required for metadata");Ce("metadata",[{name:"size",type:Gt},{name:"mimetype",type:Gt},{name:"filename",type:Gt},{name:"width",type:Gt},{name:"height",type:Gt},{name:"uploaded",type:Gt},{name:"writeable",type:Gt},{name:"cloud",type:Gt},{name:"sourceUrl",type:Gt},{name:"md5",type:Gt},{name:"sha1",type:Gt},{name:"sha224",type:Gt},{name:"sha256",type:Gt},{name:"sha384",type:Gt},{name:"sha512",type:Gt},{name:"location",type:Gt},{name:"path",type:Gt},{name:"container",type:Gt},{name:"exif",type:Gt}],r);var o=i({},r);o.source_url=o.sourceUrl,o.policy=n&&n.policy||t.policy,o.signature=n&&n.signature||t.signature;var a=t.urls.fileApiUrl+"/"+e+"/metadata";return new Promise(function(t,r){ke(a).query(Ue(o)).end(function(n,o){if(n)return r(n);t(i({},o.body,{handle:e}))})})}(this.session,t,e,r)},t.prototype.picker=function(t){return function(t,e){return new mo(t,e)}(this,t)},t.prototype.preview=function(t,e){return so(this.session,t,e)},t.prototype.remove=function(t,e){return De(this.session,t,!1,e)},t.prototype.removeMetadata=function(t,e){return De(this.session,t,!0,e)},t.prototype.storeURL=function(t,e,r,n){return function(t,e,r,n,o){if(!e||"string"!=typeof e)throw Error("url is required for storeURL");t.policy=o&&o.policy||t.policy,t.signature=o&&o.signature||t.signature;var a=new Ri(e,t.apikey);return a.setCname(t.cname),(t.urls.cdnUrl.indexOf("localhost")>-1||t.urls.cdnUrl.indexOf("badurl")>-1)&&a.setCustomDomain(t.urls.cdnUrl),t.policy&&t.signature&&a.security({policy:t.policy,signature:t.signature}),a.store(r),new Promise(function(t,e){var r=ke(""+a);return n&&(n.cancel=function(){r.abort(),e(Error("Upload cancelled"))}),r.then(function(e){if(e.body&&e.body.url){var r=e.body.url.split("/").pop(),n=i({},e.body,{handle:r,mimetype:e.body.type});return t(n)}return t(e.body)}).catch(function(t){e(t)})})}(this.session,t,e,r,n)},t.prototype.retrieve=function(t,e,r){return function(t,e,r,n){if(void 0===r&&(r={}),!e||0===e.length||"string"!=typeof e)throw Error("File handle is required");Ce("retrieveOptions",[{name:"metadata",type:Gt},{name:"head",type:Gt},{name:"dl",type:Gt},{name:"cache",type:Gt},{name:"extension",type:te}],r);var o=i({},r);o.key=t.apikey,o.policy=n&&n.policy||t.policy,o.signature=n&&n.signature||t.signature;var a,s,u=je.get,c=Se.blob;if(o.head&&(u=je.head,c=Se.json,delete o.head),o.extension&&o.extension.length&&(a=o.extension,delete o.extension),o.metadata){if(u===je.head)throw Error("Head and metadata options cannot be used together");c=Se.json,s=o.metadata,delete o.metadata}var p=t.urls.fileApiUrl+"/"+e+(a?"+"+a:"")+(s?"/metadata":"");return new Promise(function(t,e){Ae[u](p).query(o).responseType(c).end(function(r,n){return r?e(r):u===je.head?t(n.headers):void t(n.body)})})}(this.session,t,e,r)},t.prototype.transform=function(t,e,r){return void 0===r&&(r=!1),Ci(this.session,t,e,r)},t.prototype.upload=function(t,e,r,n,o){return function(t,e,r,n,o,a){return void 0===r&&(r={}),void 0===n&&(n={}),void 0===o&&(o={}),Vi(e).then(function(e){if(void 0!==e.size&&0===e.size||0===e.length)return Promise.reject(Error("file has a size of 0."));var s=[{name:"host",type:te},{name:"path",type:Gt},{name:"mimetype",type:te},{name:"partSize",type:Wt},{name:"concurrency",type:re(Qt,function(t){return t>0})},{name:"onProgress",type:Kt},{name:"progressInterval",type:Qt},{name:"onRetry",type:Kt},{name:"retry",type:Qt},{name:"retryFactor",type:Qt},{name:"retryMaxTime",type:Qt},{name:"timeout",type:Qt},{name:"intelligent",type:ne([Gt,ee.of("fallback")])},{name:"intelligentChunkSize",type:Wt}],u=te,c=ie({id:te}),p=ne([u,c]);p.dispatch=function(t){return t.id?c:u};var f=[{name:"location",type:ee.of("s3 gcs rackspace azure dropbox")},{name:"region",type:te},{name:"path",type:te},{name:"container",type:te},{name:"filename",type:te},{name:"access",type:ee.of("public private")},{name:"workflows",type:ae(p)}];Ce("upload (options)",s,r),Ce("upload (storeOptions)",f,n);var l,h=i({},n),m=i({},r);h.filename?l=h.filename:void 0===e.name&&(l=e.type?"untitled."+e.type.split("/").pop():"untitled"),void 0===h.location&&(h.location="s3"),m.intelligent&&(m.partSize=8388608);var d=i({host:t.urls.uploadApiUrl,apikey:t.apikey,policy:a&&a.policy||t.policy,signature:a&&a.signature||t.signature,partSize:6291456,concurrency:3,progressInterval:1e3,retry:10,retryFactor:2,retryMaxTime:15e3,customName:l,mimetype:r.mimetype,store:{workflows:h.workflows,store_location:h.location,store_region:h.region,store_container:h.container,store_path:h.path,store_access:h.access},timeout:12e4},m);return ao({file:e,config:d,state:{parts:{},progressTick:null,previousPayload:null,retries:{},status:Gi}},o)})}(this.session,t,e,r,n,o)},t}();t.init=function(t,e){return new yo(t,e)},t.version="2.0.3",t.TransformSchema=ze,t.getSecurity=function(){console.warn("This method is only availale in Node runtimes")},t.transform=Ci,t.Filelink=Ri,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=filestack.min.js.map
